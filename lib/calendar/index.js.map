{"version":3,"sources":["../../components/calendar/index.js"],"names":["React","moment","noop","zerofixed","v","Calendar","props","value","defaultValue","isMoment","Error","state","mode","nextProps","setState","onPanelChange","renderCalendar","Component","defaultProps","locale","fullscreen","prefixCls","onSelect","propTypes","monthCellRender","func","dateCellRender","monthFullCellRender","dateFullCellRender","bool","object","string","className","style","localeData","monthsShort","date","setValue","way","setType","type","onHeaderValueChange","onHeaderTypeChange","getDateRange","validRange","disabledDate","current","startDate","endDate","inRange","isBetween","localeCode","cls","lang"],"mappings":"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","file":"index.js","sourcesContent":["import * as React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport * as moment from 'moment';\r\nimport FullCalendar from 'rc-calendar/lib/FullCalendar';\r\nimport LocaleReceiver from '../locale-provider/LocaleReceiver';\r\nimport { PREFIX_CLS } from './Constants';\r\nimport Header from './Header';\r\nimport interopDefault from '../_util/interopDefault';\r\nimport zhCN from './locale/zh_CN';\r\n\r\n\r\n\r\nfunction noop() { return null; }\r\n\r\nfunction zerofixed(v: number) {\r\n  if (v < 10) {\r\n    return `0${v}`;\r\n  }\r\n  return `${v}`;\r\n}\r\n\r\nexport default class Calendar extends React.Component {\r\n  static defaultProps = {\r\n    locale: {},\r\n    fullscreen: true,\r\n    prefixCls: PREFIX_CLS,\r\n    mode: 'month',\r\n    onSelect: noop,\r\n    onPanelChange: noop,\r\n  };\r\n\r\n  static propTypes = {\r\n    monthCellRender: PropTypes.func,\r\n    dateCellRender: PropTypes.func,\r\n    monthFullCellRender: PropTypes.func,\r\n    dateFullCellRender: PropTypes.func,\r\n    fullscreen: PropTypes.bool,\r\n    locale: PropTypes.object,\r\n    prefixCls: PropTypes.string,\r\n    className: PropTypes.string,\r\n    style: PropTypes.object,\r\n    onPanelChange: PropTypes.func,\r\n    value: PropTypes.object,\r\n    onSelect: PropTypes.func,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const value = props.value || props.defaultValue || interopDefault(moment)();\r\n    if (!interopDefault(moment).isMoment(value)) {\r\n      throw new Error(\r\n        'The value/defaultValue of Calendar must be a moment object after `antd@2.0`, ' +\r\n        'see: https://u.ant.design/calendar-value',\r\n      );\r\n    }\r\n    this.state = {\r\n      value,\r\n      mode: props.mode,\r\n    };\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    if ('value' in nextProps) {\r\n      this.setState({\r\n        value: nextProps.value,\r\n      });\r\n    }\r\n    if ('mode' in nextProps && nextProps.mode !== this.props.mode) {\r\n      this.setState({\r\n          mode: nextProps.mode,\r\n      });\r\n    }\r\n  }\r\n\r\n  monthCellRender = (value) => {\r\n    const { prefixCls, monthCellRender = noop } = this.props;\r\n    return (\r\n      <div className={`${prefixCls}-month`}>\r\n        <div className={`${prefixCls}-value`}>\r\n          {value.localeData().monthsShort(value)}\r\n        </div>\r\n        <div className={`${prefixCls}-content`}>\r\n          {monthCellRender(value)}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  dateCellRender = (value) => {\r\n    const { prefixCls, dateCellRender = noop } = this.props;\r\n    return (\r\n      <div className={`${prefixCls}-date`}>\r\n        <div className={`${prefixCls}-value`}>\r\n          {zerofixed(value.date())}\r\n        </div>\r\n        <div className={`${prefixCls}-content`}>\r\n          {dateCellRender(value)}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  setValue = (value, way) => {\r\n    if (!('value' in this.props)) {\r\n      this.setState({ value });\r\n    }\r\n    if (way === 'select') {\r\n      if (this.props.onSelect) {\r\n        this.props.onSelect(value);\r\n      }\r\n    } else if (way === 'changePanel') {\r\n      this.onPanelChange(value, this.state.mode);\r\n    }\r\n  }\r\n\r\n  setType = (type) => {\r\n    const mode = (type === 'date') ? 'month' : 'year';\r\n    if (this.state.mode !== mode) {\r\n      this.setState({ mode });\r\n      this.onPanelChange(this.state.value, mode);\r\n    }\r\n  }\r\n\r\n  onHeaderValueChange = (value) => {\r\n    this.setValue(value, 'changePanel');\r\n  }\r\n\r\n  onHeaderTypeChange = (type) => {\r\n    this.setType(type);\r\n  }\r\n\r\n  onPanelChange(value, mode) {\r\n    const { onPanelChange } = this.props;\r\n    if (onPanelChange) {\r\n      onPanelChange(value, mode);\r\n    }\r\n  }\r\n\r\n  onSelect = (value) => {\r\n    this.setValue(value, 'select');\r\n  }\r\n\r\n  getDateRange = (\r\n    validRange,\r\n    disabledDate\r\n  ) => (current) => {\r\n      if (!current) {\r\n        return false;\r\n      }\r\n      const [ startDate, endDate ] = validRange;\r\n      const inRange = !current.isBetween(startDate, endDate, 'days', '[]');\r\n      if (disabledDate) {\r\n        return (disabledDate(current) || inRange);\r\n      }\r\n      return inRange;\r\n    }\r\n\r\n  renderCalendar = (locale, localeCode) => {\r\n    const { state, props } = this;\r\n    const { value, mode } = state;\r\n    if (value && localeCode) {\r\n      value.locale(localeCode);\r\n    }\r\n    const { prefixCls, style, className, fullscreen, dateFullCellRender, monthFullCellRender } = props;\r\n    const type = (mode === 'year') ? 'month' : 'date';\r\n\r\n    let cls = className || '';\r\n    if (fullscreen) {\r\n      cls += (` ${prefixCls}-fullscreen`);\r\n    }\r\n\r\n    const monthCellRender = monthFullCellRender || this.monthCellRender;\r\n    const dateCellRender = dateFullCellRender || this.dateCellRender;\r\n\r\n    let disabledDate = props.disabledDate;\r\n\r\n    if (props.validRange) {\r\n      disabledDate = this.getDateRange(props.validRange, disabledDate);\r\n    }\r\n\r\n    return (\r\n      <div className={cls} style={style}>\r\n        <Header\r\n          fullscreen={fullscreen}\r\n          type={type}\r\n          value={value}\r\n          locale={locale.lang}\r\n          prefixCls={prefixCls}\r\n          onTypeChange={this.onHeaderTypeChange}\r\n          onValueChange={this.onHeaderValueChange}\r\n          validRange={props.validRange}\r\n        />\r\n        <FullCalendar\r\n          {...props}\r\n          disabledDate={disabledDate}\r\n          Select={noop}\r\n          locale={locale.lang}\r\n          type={type}\r\n          prefixCls={prefixCls}\r\n          showHeader={false}\r\n          value={value}\r\n          monthCellRender={monthCellRender}\r\n          dateCellRender={dateCellRender}\r\n          onSelect={this.onSelect}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <LocaleReceiver\r\n        componentName=\"Calendar\"\r\n        defaultLocale={zhCN}\r\n      >\r\n        {this.renderCalendar}\r\n      </LocaleReceiver>\r\n    );\r\n  }\r\n}\r\n"]}