{"version":3,"sources":["../../components/calendar/index.js"],"names":["React","moment","noop","zerofixed","v","Calendar","props","value","defaultValue","isMoment","Error","state","mode","nextProps","setState","onPanelChange","renderCalendar","Component","defaultProps","locale","fullscreen","prefixCls","onSelect","propTypes","monthCellRender","func","dateCellRender","monthFullCellRender","dateFullCellRender","bool","object","string","className","style","localeData","monthsShort","date","setValue","way","setType","type","onHeaderValueChange","onHeaderTypeChange","getDateRange","validRange","disabledDate","current","startDate","endDate","inRange","isBetween","localeCode","cls","lang"],"mappings":"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","file":"index.js","sourcesContent":["import * as React from 'react';\nimport PropTypes from 'prop-types';\nimport * as moment from 'moment';\nimport FullCalendar from 'rc-calendar/lib/FullCalendar';\nimport LocaleReceiver from '../locale-provider/LocaleReceiver';\nimport { PREFIX_CLS } from './Constants';\nimport Header from './Header';\nimport interopDefault from '../_util/interopDefault';\nimport zhCN from './locale/zh_CN';\n\n\n\nfunction noop() { return null; }\n\nfunction zerofixed(v: number) {\n  if (v < 10) {\n    return `0${v}`;\n  }\n  return `${v}`;\n}\n\nexport default class Calendar extends React.Component {\n  static defaultProps = {\n    locale: {},\n    fullscreen: true,\n    prefixCls: PREFIX_CLS,\n    mode: 'month',\n    onSelect: noop,\n    onPanelChange: noop,\n  };\n\n  static propTypes = {\n    monthCellRender: PropTypes.func,\n    dateCellRender: PropTypes.func,\n    monthFullCellRender: PropTypes.func,\n    dateFullCellRender: PropTypes.func,\n    fullscreen: PropTypes.bool,\n    locale: PropTypes.object,\n    prefixCls: PropTypes.string,\n    className: PropTypes.string,\n    style: PropTypes.object,\n    onPanelChange: PropTypes.func,\n    value: PropTypes.object,\n    onSelect: PropTypes.func,\n  };\n\n  constructor(props) {\n    super(props);\n\n    const value = props.value || props.defaultValue || interopDefault(moment)();\n    if (!interopDefault(moment).isMoment(value)) {\n      throw new Error(\n        'The value/defaultValue of Calendar must be a moment object after `antd@2.0`, ' +\n        'see: https://u.ant.design/calendar-value',\n      );\n    }\n    this.state = {\n      value,\n      mode: props.mode,\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if ('value' in nextProps) {\n      this.setState({\n        value: nextProps.value,\n      });\n    }\n    if ('mode' in nextProps && nextProps.mode !== this.props.mode) {\n      this.setState({\n          mode: nextProps.mode,\n      });\n    }\n  }\n\n  monthCellRender = (value) => {\n    const { prefixCls, monthCellRender = noop } = this.props;\n    return (\n      <div className={`${prefixCls}-month`}>\n        <div className={`${prefixCls}-value`}>\n          {value.localeData().monthsShort(value)}\n        </div>\n        <div className={`${prefixCls}-content`}>\n          {monthCellRender(value)}\n        </div>\n      </div>\n    );\n  }\n\n  dateCellRender = (value) => {\n    const { prefixCls, dateCellRender = noop } = this.props;\n    return (\n      <div className={`${prefixCls}-date`}>\n        <div className={`${prefixCls}-value`}>\n          {zerofixed(value.date())}\n        </div>\n        <div className={`${prefixCls}-content`}>\n          {dateCellRender(value)}\n        </div>\n      </div>\n    );\n  }\n\n  setValue = (value, way) => {\n    if (!('value' in this.props)) {\n      this.setState({ value });\n    }\n    if (way === 'select') {\n      if (this.props.onSelect) {\n        this.props.onSelect(value);\n      }\n    } else if (way === 'changePanel') {\n      this.onPanelChange(value, this.state.mode);\n    }\n  }\n\n  setType = (type) => {\n    const mode = (type === 'date') ? 'month' : 'year';\n    if (this.state.mode !== mode) {\n      this.setState({ mode });\n      this.onPanelChange(this.state.value, mode);\n    }\n  }\n\n  onHeaderValueChange = (value) => {\n    this.setValue(value, 'changePanel');\n  }\n\n  onHeaderTypeChange = (type) => {\n    this.setType(type);\n  }\n\n  onPanelChange(value, mode) {\n    const { onPanelChange } = this.props;\n    if (onPanelChange) {\n      onPanelChange(value, mode);\n    }\n  }\n\n  onSelect = (value) => {\n    this.setValue(value, 'select');\n  }\n\n  getDateRange = (\n    validRange,\n    disabledDate\n  ) => (current) => {\n      if (!current) {\n        return false;\n      }\n      const [ startDate, endDate ] = validRange;\n      const inRange = !current.isBetween(startDate, endDate, 'days', '[]');\n      if (disabledDate) {\n        return (disabledDate(current) || inRange);\n      }\n      return inRange;\n    }\n\n  renderCalendar = (locale, localeCode) => {\n    const { state, props } = this;\n    const { value, mode } = state;\n    if (value && localeCode) {\n      value.locale(localeCode);\n    }\n    const { prefixCls, style, className, fullscreen, dateFullCellRender, monthFullCellRender } = props;\n    const type = (mode === 'year') ? 'month' : 'date';\n\n    let cls = className || '';\n    if (fullscreen) {\n      cls += (` ${prefixCls}-fullscreen`);\n    }\n\n    const monthCellRender = monthFullCellRender || this.monthCellRender;\n    const dateCellRender = dateFullCellRender || this.dateCellRender;\n\n    let disabledDate = props.disabledDate;\n\n    if (props.validRange) {\n      disabledDate = this.getDateRange(props.validRange, disabledDate);\n    }\n\n    return (\n      <div className={cls} style={style}>\n        <Header\n          fullscreen={fullscreen}\n          type={type}\n          value={value}\n          locale={locale.lang}\n          prefixCls={prefixCls}\n          onTypeChange={this.onHeaderTypeChange}\n          onValueChange={this.onHeaderValueChange}\n          validRange={props.validRange}\n        />\n        <FullCalendar\n          {...props}\n          disabledDate={disabledDate}\n          Select={noop}\n          locale={locale.lang}\n          type={type}\n          prefixCls={prefixCls}\n          showHeader={false}\n          value={value}\n          monthCellRender={monthCellRender}\n          dateCellRender={dateCellRender}\n          onSelect={this.onSelect}\n        />\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <LocaleReceiver\n        componentName=\"Calendar\"\n        defaultLocale={zhCN}\n      >\n        {this.renderCalendar}\n      </LocaleReceiver>\n    );\n  }\n}\n"]}