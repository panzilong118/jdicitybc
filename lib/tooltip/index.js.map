{"version":3,"sources":["../../components/tooltip/index.js"],"names":["React","splitObject","obj","keys","picked","omitted","forEach","key","Tooltip","props","onVisibleChange","visible","setState","isNoTitle","onPopupAlign","domNode","align","placements","getPlacements","placement","Object","filter","points","rect","getBoundingClientRect","transformOrigin","top","left","indexOf","height","offset","width","style","saveTooltip","node","tooltip","state","defaultVisible","nextProps","getPopupDomNode","builtinPlacements","arrowPointAtCenter","autoAdjustOverflow","verticalArrowShift","trigger","Array","isArray","element","type","__JC_BUTTON","disabled","isHoverTrigger","spanStyle","display","cursor","buttonStyle","pointerEvents","child","className","title","overlay","prefixCls","openClassName","getPopupContainer","getTooltipContainer","children","getDisabledCompatibleChildren","isValidElement","childProps","childCls","Component","defaultProps","transitionName","mouseEnterDelay","mouseLeaveDelay"],"mappings":"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","file":"index.js","sourcesContent":["import * as React from 'react';\r\nimport { cloneElement } from 'react';\r\nimport RcTooltip from 'rc-tooltip';\r\nimport classNames from 'classnames';\r\nimport getPlacements from './placements';\r\n// eslint校验变量未使用，暂时注释掉\r\n// import Button from '../button/index';\r\n\r\nconst splitObject = (obj, keys) => {\r\n    const picked = {};\r\n    const omitted = { ...obj };\r\n    keys.forEach((key) => {\r\n        if (obj && key in obj) {\r\n            picked[key] = obj[key];\r\n            delete omitted[key];\r\n        }\r\n    });\r\n    return { picked, omitted };\r\n};\r\n\r\nexport default class Tooltip extends React.Component {\r\n    static defaultProps = {\r\n        prefixCls: 'jc-tooltip',\r\n        placement: 'top',\r\n        transitionName: 'zoom-big-fast',\r\n        mouseEnterDelay: 0.1,\r\n        mouseLeaveDelay: 0.1,\r\n        arrowPointAtCenter: false,\r\n        autoAdjustOverflow: true,\r\n    };\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            visible: !!props.visible || !!props.defaultVisible,\r\n        };\r\n        this.tooltip = {};\r\n    }\r\n\r\n    componentWillReceiveProps(nextProps) {\r\n        if ('visible' in nextProps) {\r\n            this.setState({ visible: nextProps.visible });\r\n        }\r\n    }\r\n\r\n    onVisibleChange = (visible) => {\r\n        const { onVisibleChange } = this.props;\r\n        if (!('visible' in this.props)) {\r\n            this.setState({ visible: this.isNoTitle() ? false : visible });\r\n        }\r\n        if (onVisibleChange && !this.isNoTitle()) {\r\n            onVisibleChange(visible);\r\n        }\r\n    }\r\n\r\n    getPopupDomNode() {\r\n        return this.tooltip.getPopupDomNode();\r\n    }\r\n\r\n    getPlacements() {\r\n        const { builtinPlacements, arrowPointAtCenter, autoAdjustOverflow } = this.props;\r\n        return builtinPlacements || getPlacements({\r\n            arrowPointAtCenter,\r\n            verticalArrowShift: 8,\r\n            autoAdjustOverflow,\r\n        });\r\n    }\r\n\r\n    isHoverTrigger() {\r\n        const { trigger } = this.props;\r\n        if (!trigger || trigger === 'hover') {\r\n            return true;\r\n        }\r\n        if (Array.isArray(trigger)) {\r\n            return trigger.indexOf('hover') >= 0;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    // Fix Tooltip won't hide at disabled button\r\n    // mouse events don't trigger at disabled button in Chrome\r\n    // https://github.com/react-component/tooltip/issues/18\r\n    getDisabledCompatibleChildren(element) {\r\n        if ((element.type.__JC_BUTTON || element.type === 'button') &&\r\n            element.props.disabled && this.isHoverTrigger()) {\r\n            // Pick some layout related style properties up to span\r\n            // Prevent layout bugs like https://github.com/ant-design/ant-design/issues/5254\r\n            const { picked, omitted } = splitObject(\r\n                element.props.style,\r\n                ['position', 'left', 'right', 'top', 'bottom', 'float', 'display', 'zIndex'],\r\n            );\r\n            const spanStyle = {\r\n                display: 'inline-block', // default inline-block is important\r\n                ...picked,\r\n                cursor: 'not-allowed',\r\n            };\r\n            const buttonStyle = {\r\n                ...omitted,\r\n                pointerEvents: 'none',\r\n            };\r\n            const child = cloneElement(element, {\r\n                style: buttonStyle,\r\n                className: null,\r\n            });\r\n            return (\r\n                <span style={spanStyle} className={element.props.className}>\r\n                    {child}\r\n                </span>\r\n            );\r\n        }\r\n        return element;\r\n    }\r\n\r\n    isNoTitle() {\r\n        const { title, overlay } = this.props;\r\n        return !title && !overlay; // overlay for old version compatibility\r\n    }\r\n\r\n    // 动态设置动画点\r\n    onPopupAlign = (domNode, align) => {\r\n        const placements = this.getPlacements();\r\n        // 当前返回的位置\r\n        const placement = Object.keys(placements).filter(key => (placements[key].points[0] === align.points[0] && placements[key].points[1] === align.points[1]))[0];\r\n        if (!placement) {\r\n            return;\r\n        }\r\n        // 根据当前坐标设置动画点\r\n        const rect = domNode.getBoundingClientRect();\r\n        const transformOrigin = {\r\n            top: '50%',\r\n            left: '50%',\r\n        };\r\n        if (placement.indexOf('top') >= 0 || placement.indexOf('Bottom') >= 0) {\r\n            transformOrigin.top = `${rect.height - align.offset[1]}px`;\r\n        } else if (placement.indexOf('Top') >= 0 || placement.indexOf('bottom') >= 0) {\r\n            transformOrigin.top = `${-align.offset[1]}px`;\r\n        }\r\n        if (placement.indexOf('left') >= 0 || placement.indexOf('Right') >= 0) {\r\n            transformOrigin.left = `${rect.width - align.offset[0]}px`;\r\n        } else if (placement.indexOf('right') >= 0 || placement.indexOf('Left') >= 0) {\r\n            transformOrigin.left = `${-align.offset[0]}px`;\r\n        }\r\n        domNode.style.transformOrigin = `${transformOrigin.left} ${transformOrigin.top}`;\r\n    }\r\n\r\n    saveTooltip = (node) => {\r\n        this.tooltip = node;\r\n    }\r\n\r\n    render() {\r\n        const { props, state } = this;\r\n        const { prefixCls, title, overlay, openClassName, getPopupContainer, getTooltipContainer } = props;\r\n        const children = props.children;\r\n        let visible = state.visible;\r\n        // Hide tooltip when there is no title\r\n        if (!('visible' in props) && this.isNoTitle()) {\r\n            visible = false;\r\n        }\r\n\r\n        const child = this.getDisabledCompatibleChildren(React.isValidElement(children) ? children : <span>{children}</span>);\r\n        const childProps = child.props;\r\n        const childCls = classNames(childProps.className, {\r\n            [openClassName || `${prefixCls}-open`]: true,\r\n        });\r\n\r\n        return (\r\n            <RcTooltip\r\n                {...this.props}\r\n                getTooltipContainer={getPopupContainer || getTooltipContainer}\r\n                ref={this.saveTooltip}\r\n                builtinPlacements={this.getPlacements()}\r\n                overlay={overlay || title || ''}\r\n                visible={visible}\r\n                onVisibleChange={this.onVisibleChange}\r\n                onPopupAlign={this.onPopupAlign}\r\n            >\r\n                {visible ? cloneElement(child, { className: childCls }) : child}\r\n            </RcTooltip>\r\n        );\r\n    }\r\n}\r\n"]}