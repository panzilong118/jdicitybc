{"version":3,"sources":["../../components/back-top/index.js"],"names":["React","reqAnimFrame","easeInOutCubic","t","b","c","d","cc","noop","getDefaultTarget","window","BackTopProps","visibilityHeight","number","onClick","func","target","any","prefixCls","string","className","style","object","right","oneOfType","bottom","BackTop","props","getCurrentScrollTop","getTarget","targetNode","pageYOffset","document","body","scrollTop","documentElement","scrollToTop","e","startTime","Date","now","frameFunc","timestamp","time","setScrollTop","handleScroll","setState","visible","state","scrollEvent","undefined","value","remove","children","classString","defaultElement","divProps","backTopBtn","Component","defaultProps","propTypes"],"mappings":"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","file":"index.js","sourcesContent":["import * as React from 'react';\r\n\r\nimport PropTypes from 'prop-types';\r\n\r\nimport Animate from 'rc-animate';\r\n\r\nimport addEventListener from 'rc-util/lib/Dom/addEventListener';\r\n\r\nimport classNames from 'classnames';\r\n\r\nimport omit from 'omit.js';\r\n\r\nimport getScroll from '../_util/getScroll';\r\n\r\nimport getRequestAnimationFrame from '../_util/getRequestAnimationFrame';\r\n\r\nconst reqAnimFrame = getRequestAnimationFrame();\r\n\r\nconst easeInOutCubic = (t, b, c, d) => {\r\n    const cc = c - b;\r\n    t /= d / 2;\r\n    if (t < 1) {\r\n        return cc / 2 * t * t * t + b;\r\n    } else {\r\n        return cc / 2 * ((t -= 2) * t * t + 2) + b;\r\n    }\r\n};\r\n\r\nfunction noop() { }\r\n\r\nfunction getDefaultTarget() {\r\n    return window;\r\n}\r\n\r\nexport const BackTopProps = {\r\n    visibilityHeight: PropTypes.number, // 滚动高度达到此参数值才出现 BackTop\r\n    onClick: PropTypes.func, // 点击按钮的回调函数\r\n    target: PropTypes.any, // 设置需要监听其滚动事件的元素，值为一个返回对应 DOM 元素的函数,即说明：可以设置div等元素作为滚动框\r\n    prefixCls: PropTypes.string,\r\n    className: PropTypes.string,\r\n    style: PropTypes.object,\r\n    right: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n    bottom: PropTypes.oneOfType([PropTypes.number, PropTypes.string])\r\n}\r\n\r\nexport default class BackTop extends React.Component {\r\n    static defaultProps = {\r\n        visibilityHeight: 400,\r\n        style: {},\r\n        className: ''\r\n    };\r\n    static propTypes = { ...BackTopProps };\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            visible: false\r\n        };\r\n        this.scrollEvent = undefined;\r\n    }\r\n\r\n    /**\r\n     * 获取当前的ScrollTop值\r\n     */\r\n    getCurrentScrollTop = () => {\r\n        const getTarget = this.props.target || getDefaultTarget;\r\n        const targetNode = getTarget();\r\n        if (targetNode === window) {\r\n            return window.pageYOffset || document.body.scrollTop || document.documentElement.scrollTop;\r\n        }\r\n        return targetNode.scrollTop;\r\n    }\r\n\r\n    /**\r\n     * 滚动到顶部，有动画效果\r\n     */\r\n    scrollToTop = (e) => {\r\n        const scrollTop = this.getCurrentScrollTop();\r\n        const startTime = Date.now();\r\n        const frameFunc = () => {\r\n            const timestamp = Date.now();\r\n            const time = timestamp - startTime;\r\n            this.setScrollTop(easeInOutCubic(time, scrollTop, 0, 450));\r\n            if (time < 450) {\r\n                reqAnimFrame(frameFunc);\r\n            }\r\n        };\r\n        reqAnimFrame(frameFunc);\r\n        (this.props.onClick || noop)(e);\r\n    }\r\n\r\n    /**\r\n     * 滚动到指定位置\r\n     * @param {*滚动距离} value \r\n     */\r\n    setScrollTop(value) {\r\n        const getTarget = this.props.target || getDefaultTarget;\r\n        const targetNode = getTarget();\r\n        if (targetNode === window) {\r\n            document.body.scrollTop = value;\r\n            document.documentElement.scrollTop = value;\r\n        } else {\r\n            targetNode.scrollTop = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 处理Backtop的显示或隐藏\r\n     */\r\n    handleScroll = () => {\r\n        const { visibilityHeight, target = getDefaultTarget } = this.props;\r\n        const scrollTop = getScroll(target(), true);\r\n        this.setState({\r\n            visible: scrollTop > visibilityHeight\r\n        });\r\n    }\r\n\r\n    componentDidMount() {\r\n        // 获取BackTop处理的目标元素，可是Widow，也可以是divD等元素\r\n        const getTarget = this.props.target || getDefaultTarget;\r\n        // 绑定滚动监听事件\r\n        this.scrollEvent = addEventListener(getTarget(), 'scroll', this.handleScroll);\r\n        // 处理滚动事件\r\n        this.handleScroll();\r\n    }\r\n\r\n    /**\r\n     * 移除滚动监听事件\r\n     */\r\n    componentWillUnmount() {\r\n        if (this.scrollEvent) {\r\n            this.scrollEvent.remove();\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const { prefixCls = 'jc-back-top', className = '', children, right, bottom } = this.props;\r\n        let { style = {} } = this.props;\r\n        if (right && !style.right) {\r\n            style.right = right;\r\n        }\r\n         if (bottom && !style.bottom) {\r\n            style.bottom = bottom;\r\n        }\r\n        const classString = classNames(prefixCls, className);\r\n\r\n        const defaultElement = (\r\n            <div className={`${prefixCls}-content`}>\r\n                <div className={`${prefixCls}-icon`} />\r\n            </div>\r\n        );\r\n\r\n        // fix https://fb.me/react-unknown-prop\r\n        const divProps = omit(this.props, [\r\n            'style',\r\n            'right',\r\n            'bottom',\r\n            'prefixCls',\r\n            'className',\r\n            'children',\r\n            'visibilityHeight',\r\n            'target',\r\n        ]);\r\n\r\n        const backTopBtn = this.state.visible ? (\r\n            <div {...divProps} style={style} className={classString} onClick={this.scrollToTop}>\r\n                {children || defaultElement}\r\n            </div>\r\n        ) : null;\r\n\r\n        return (\r\n            <Animate component=\"\" transitionName=\"fade\">\r\n                {backTopBtn}\r\n            </Animate>\r\n        );\r\n    }\r\n}\r\n"]}