{"version":3,"sources":["../../components/back-top/index.js"],"names":["React","reqAnimFrame","easeInOutCubic","t","b","c","d","cc","noop","getDefaultTarget","window","BackTopProps","visibilityHeight","number","onClick","func","target","any","prefixCls","string","className","style","object","right","oneOfType","bottom","BackTop","props","getCurrentScrollTop","getTarget","targetNode","pageYOffset","document","body","scrollTop","documentElement","scrollToTop","e","startTime","Date","now","frameFunc","timestamp","time","setScrollTop","handleScroll","setState","visible","state","scrollEvent","undefined","value","remove","children","classString","defaultElement","divProps","backTopBtn","Component","defaultProps","propTypes"],"mappings":"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","file":"index.js","sourcesContent":["import * as React from 'react';\n\nimport PropTypes from 'prop-types';\n\nimport Animate from 'rc-animate';\n\nimport addEventListener from 'rc-util/lib/Dom/addEventListener';\n\nimport classNames from 'classnames';\n\nimport omit from 'omit.js';\n\nimport getScroll from '../_util/getScroll';\n\nimport getRequestAnimationFrame from '../_util/getRequestAnimationFrame';\n\nconst reqAnimFrame = getRequestAnimationFrame();\n\nconst easeInOutCubic = (t, b, c, d) => {\n    const cc = c - b;\n    t /= d / 2;\n    if (t < 1) {\n        return cc / 2 * t * t * t + b;\n    } else {\n        return cc / 2 * ((t -= 2) * t * t + 2) + b;\n    }\n};\n\nfunction noop() { }\n\nfunction getDefaultTarget() {\n    return window;\n}\n\nexport const BackTopProps = {\n    visibilityHeight: PropTypes.number, // 滚动高度达到此参数值才出现 BackTop\n    onClick: PropTypes.func, // 点击按钮的回调函数\n    target: PropTypes.any, // 设置需要监听其滚动事件的元素，值为一个返回对应 DOM 元素的函数,即说明：可以设置div等元素作为滚动框\n    prefixCls: PropTypes.string,\n    className: PropTypes.string,\n    style: PropTypes.object,\n    right: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    bottom: PropTypes.oneOfType([PropTypes.number, PropTypes.string])\n}\n\nexport default class BackTop extends React.Component {\n    static defaultProps = {\n        visibilityHeight: 400,\n        style: {},\n        className: ''\n    };\n    static propTypes = { ...BackTopProps };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            visible: false\n        };\n        this.scrollEvent = undefined;\n    }\n\n    /**\n     * 获取当前的ScrollTop值\n     */\n    getCurrentScrollTop = () => {\n        const getTarget = this.props.target || getDefaultTarget;\n        const targetNode = getTarget();\n        if (targetNode === window) {\n            return window.pageYOffset || document.body.scrollTop || document.documentElement.scrollTop;\n        }\n        return targetNode.scrollTop;\n    }\n\n    /**\n     * 滚动到顶部，有动画效果\n     */\n    scrollToTop = (e) => {\n        const scrollTop = this.getCurrentScrollTop();\n        const startTime = Date.now();\n        const frameFunc = () => {\n            const timestamp = Date.now();\n            const time = timestamp - startTime;\n            this.setScrollTop(easeInOutCubic(time, scrollTop, 0, 450));\n            if (time < 450) {\n                reqAnimFrame(frameFunc);\n            }\n        };\n        reqAnimFrame(frameFunc);\n        (this.props.onClick || noop)(e);\n    }\n\n    /**\n     * 滚动到指定位置\n     * @param {*滚动距离} value \n     */\n    setScrollTop(value) {\n        const getTarget = this.props.target || getDefaultTarget;\n        const targetNode = getTarget();\n        if (targetNode === window) {\n            document.body.scrollTop = value;\n            document.documentElement.scrollTop = value;\n        } else {\n            targetNode.scrollTop = value;\n        }\n    }\n\n    /**\n     * 处理Backtop的显示或隐藏\n     */\n    handleScroll = () => {\n        const { visibilityHeight, target = getDefaultTarget } = this.props;\n        const scrollTop = getScroll(target(), true);\n        this.setState({\n            visible: scrollTop > visibilityHeight\n        });\n    }\n\n    componentDidMount() {\n        // 获取BackTop处理的目标元素，可是Widow，也可以是divD等元素\n        const getTarget = this.props.target || getDefaultTarget;\n        // 绑定滚动监听事件\n        this.scrollEvent = addEventListener(getTarget(), 'scroll', this.handleScroll);\n        // 处理滚动事件\n        this.handleScroll();\n    }\n\n    /**\n     * 移除滚动监听事件\n     */\n    componentWillUnmount() {\n        if (this.scrollEvent) {\n            this.scrollEvent.remove();\n        }\n    }\n\n    render() {\n        const { prefixCls = 'jc-back-top', className = '', children, right, bottom } = this.props;\n        let { style = {} } = this.props;\n        if (right && !style.right) {\n            style.right = right;\n        }\n         if (bottom && !style.bottom) {\n            style.bottom = bottom;\n        }\n        const classString = classNames(prefixCls, className);\n\n        const defaultElement = (\n            <div className={`${prefixCls}-content`}>\n                <div className={`${prefixCls}-icon`} />\n            </div>\n        );\n\n        // fix https://fb.me/react-unknown-prop\n        const divProps = omit(this.props, [\n            'style',\n            'right',\n            'bottom',\n            'prefixCls',\n            'className',\n            'children',\n            'visibilityHeight',\n            'target',\n        ]);\n\n        const backTopBtn = this.state.visible ? (\n            <div {...divProps} style={style} className={classString} onClick={this.scrollToTop}>\n                {children || defaultElement}\n            </div>\n        ) : null;\n\n        return (\n            <Animate component=\"\" transitionName=\"fade\">\n                {backTopBtn}\n            </Animate>\n        );\n    }\n}\n"]}