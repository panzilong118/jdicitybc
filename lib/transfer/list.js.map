{"version":3,"sources":["../../components/transfer/list.js"],"names":["React","ReactDOM","noop","isRenderResultPlainObject","result","isValidElement","Object","prototype","toString","call","TransferList","props","handleSelect","selectedItem","checkedKeys","some","key","handleFilter","e","target","value","triggerScrollTimer","window","setTimeout","transferNode","findDOMNode","listNode","querySelectorAll","handleClear","matchFilter","text","item","filter","filterOption","indexOf","renderItem","render","renderResult","isRenderResultPlain","renderedText","renderedEl","label","state","mounted","timer","setState","clearTimeout","args","shouldComponentUpdate","apply","filteredDataSource","length","every","prefixCls","dataSource","titleText","lazy","body","footer","showSearch","style","searchPlaceholder","notFoundContent","itemUnit","itemsUnit","onScroll","footerDom","bodyDom","listCls","totalDataSource","showItems","map","trim","push","disabled","checked","unit","search","listBody","listFooter","checkStatus","getCheckStatus","checkedAll","checkAllCheckbox","handleSelectAll","Component","defaultProps"],"mappings":"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","file":"list.js","sourcesContent":["/**\r\n * @author panzilong\r\n * @version 1.0.0\r\n */\r\n\r\n import * as React from 'react';\r\n import * as ReactDOM from 'react-dom';\r\n import classNames from 'classnames';\r\n import Animate from 'rc-animate';\r\n import PureRenderMixin from 'rc-util/lib/PureRenderMixin';\r\n import Checkbox from '../checkbox';\r\n import { TransferItem } from './index';\r\n import Search from './search';\r\n import Item from './item';\r\n import triggerEvent from '../_util/triggerEvent';\r\n\r\n function noop() {\r\n }\r\n\r\n function isRenderResultPlainObject(result) {\r\n   return result && !React.isValidElement(result) &&\r\n     Object.prototype.toString.call(result) === '[object Object]';\r\n }\r\n\r\n export default class TransferList extends React.Component {\r\n   static defaultProps = {\r\n     dataSource: [],\r\n     titleText: '',\r\n     showSearch: false,\r\n     render: noop,\r\n     lazy: {},\r\n   };\r\n\r\n   constructor(props) {\r\n     super(props);\r\n     this.state = {\r\n       mounted: false,\r\n     };\r\n   }\r\n\r\n   componentDidMount() {\r\n     this.timer = window.setTimeout(() => {\r\n       this.setState({\r\n         mounted: true,\r\n       });\r\n     }, 0);\r\n   }\r\n\r\n   componentWillUnmount() {\r\n     clearTimeout(this.timer);\r\n     clearTimeout(this.triggerScrollTimer);\r\n   }\r\n\r\n   shouldComponentUpdate(...args) {\r\n     return PureRenderMixin.shouldComponentUpdate.apply(this, args);\r\n   }\r\n\r\n   getCheckStatus(filteredDataSource) {\r\n     const { checkedKeys } = this.props;\r\n     if (checkedKeys.length === 0) {\r\n       return 'none';\r\n     } else if (filteredDataSource.every(item => checkedKeys.indexOf(item.key) >= 0)) {\r\n       return 'all';\r\n     }\r\n     return 'part';\r\n   }\r\n\r\n   handleSelect = (selectedItem) => {\r\n     const { checkedKeys } = this.props;\r\n     const result = checkedKeys.some((key) => key === selectedItem.key);\r\n     this.props.handleSelect(selectedItem, !result);\r\n   }\r\n\r\n   handleFilter = (e) => {\r\n     this.props.handleFilter(e);\r\n     if (!e.target.value) {\r\n       return;\r\n     }\r\n     // Manually trigger scroll event for lazy search bug\r\n     // https://github.com/ant-design/ant-design/issues/5631\r\n     this.triggerScrollTimer = window.setTimeout(() => {\r\n       const transferNode = ReactDOM.findDOMNode(this);\r\n       const listNode = transferNode.querySelectorAll('.jc-transfer-list-content')[0];\r\n       if (listNode) {\r\n         triggerEvent(listNode, 'scroll');\r\n       }\r\n     }, 0);\r\n   }\r\n\r\n   handleClear = () => {\r\n     this.props.handleClear();\r\n   }\r\n\r\n   matchFilter = (text, item) => {\r\n     const { filter, filterOption } = this.props;\r\n     if (filterOption) {\r\n       return filterOption(filter, item);\r\n     }\r\n     return text.indexOf(filter) >= 0;\r\n   }\r\n\r\n   renderItem = (item) => {\r\n     const { render = noop } = this.props;\r\n     const renderResult = render(item);\r\n     const isRenderResultPlain = isRenderResultPlainObject(renderResult);\r\n     return {\r\n       renderedText: isRenderResultPlain ? renderResult.value : renderResult,\r\n       renderedEl: isRenderResultPlain ? renderResult.label : renderResult,\r\n     };\r\n   }\r\n\r\n   render() {\r\n     const {\r\n       prefixCls, dataSource, titleText, checkedKeys, lazy,\r\n       body = noop, footer = noop, showSearch, style, filter,\r\n       searchPlaceholder, notFoundContent, itemUnit, itemsUnit, onScroll,\r\n     } = this.props;\r\n\r\n     // Custom Layout\r\n     const footerDom = footer({ ...this.props });\r\n     const bodyDom = body({ ...this.props });\r\n\r\n     const listCls = classNames(prefixCls, {\r\n       [`${prefixCls}-with-footer`]: !!footerDom,\r\n     });\r\n\r\n     const filteredDataSource = [];\r\n     const totalDataSource = [];\r\n\r\n     const showItems = dataSource.map((item) => {\r\n       const { renderedText, renderedEl } = this.renderItem(item);\r\n       if (filter && filter.trim() && !this.matchFilter(renderedText, item)) {\r\n         return null;\r\n       }\r\n\r\n       // all show items\r\n       totalDataSource.push(item);\r\n       if (!item.disabled) {\r\n          // response to checkAll items\r\n         filteredDataSource.push(item);\r\n       }\r\n\r\n       const checked = checkedKeys.indexOf(item.key) >= 0;\r\n       return (\r\n         <Item\r\n           key={item.key}\r\n           item={item}\r\n           lazy={lazy}\r\n           renderedText={renderedText}\r\n           renderedEl={renderedEl}\r\n           checked={checked}\r\n           prefixCls={prefixCls}\r\n           onClick={this.handleSelect}\r\n         />\r\n       );\r\n     });\r\n\r\n     const unit = dataSource.length > 1 ? itemsUnit : itemUnit;\r\n\r\n     const search = showSearch ? (\r\n       <div className={`${prefixCls}-body-search-wrapper`}>\r\n         <Search\r\n           prefixCls={`${prefixCls}-search`}\r\n           onChange={this.handleFilter}\r\n           handleClear={this.handleClear}\r\n           placeholder={searchPlaceholder}\r\n           value={filter}\r\n         />\r\n       </div>\r\n     ) : null;\r\n\r\n     const listBody = bodyDom || (\r\n       <div className={showSearch ? `${prefixCls}-body ${prefixCls}-body-with-search` : `${prefixCls}-body`}>\r\n         {search}\r\n         <Animate\r\n           component=\"ul\"\r\n           componentProps={{ onScroll }}\r\n           className={`${prefixCls}-content`}\r\n           transitionName={this.state.mounted ? `${prefixCls}-content-item-highlight` : ''}\r\n           transitionLeave={false}\r\n         >\r\n           {showItems}\r\n         </Animate>\r\n         <div className={`${prefixCls}-body-not-found`}>\r\n           {notFoundContent}\r\n         </div>\r\n       </div>\r\n     );\r\n\r\n     const listFooter = footerDom ? (\r\n       <div className={`${prefixCls}-footer`}>\r\n         {footerDom}\r\n       </div>\r\n     ) : null;\r\n\r\n     const checkStatus = this.getCheckStatus(filteredDataSource);\r\n     const checkedAll = checkStatus === 'all';\r\n     const checkAllCheckbox = (\r\n       <Checkbox\r\n         ref=\"checkbox\"\r\n         checked={checkedAll}\r\n         indeterminate={checkStatus === 'part'}\r\n         onChange={() => this.props.handleSelectAll(filteredDataSource, checkedAll)}\r\n       />\r\n     );\r\n\r\n     return (\r\n       <div className={listCls} style={style}>\r\n         <div className={`${prefixCls}-header`}>\r\n           {checkAllCheckbox}\r\n           <span className={`${prefixCls}-header-selected`}>\r\n             <span>\r\n               {(checkedKeys.length > 0 ? `${checkedKeys.length}/` : '') + totalDataSource.length} {unit}\r\n             </span>\r\n             <span className={`${prefixCls}-header-title`}>\r\n               {titleText}\r\n             </span>\r\n           </span>\r\n         </div>\r\n         {listBody}\r\n         {listFooter}\r\n       </div>\r\n     );\r\n   }\r\n }\r\n"]}