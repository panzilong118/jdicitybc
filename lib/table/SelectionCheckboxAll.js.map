{"version":3,"sources":["../../components/table/SelectionCheckboxAll.js"],"names":["React","SelectionCheckboxAll","props","handleSelectAllChagne","e","checked","target","onSelect","defaultSelections","hideDefaultSelections","key","text","locale","selectAll","selectInvert","unsubscribe","state","getCheckState","indeterminate","getIndeterminateState","subscribe","nextProps","setCheckState","store","data","type","byDefaultChecked","getCheckboxPropsByItem","getRecordKey","item","i","defaultChecked","getState","selectedRowKeys","indexOf","setState","length","selectionDirty","checkSelection","selections","map","selection","index","disabled","prefixCls","getPopupContainer","selectionPrefixCls","customSelections","newSelections","Array","isArray","concat","menu","renderMenus","Component","propTypes"],"mappings":"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","file":"SelectionCheckboxAll.js","sourcesContent":["import * as React from 'react';\r\n\r\nimport PropTypes from 'prop-types';\r\n\r\nimport Checkbox from '../checkbox';\r\n\r\nimport Dropdown from '../dropdown';\r\n\r\nimport Menu from '../menu';\r\n\r\nimport Icon from '../icon';\r\n\r\nimport classNames from 'classnames';\r\n\r\nimport { SelectionCheckboxAllProps } from './interface';\r\n\r\nexport default class SelectionCheckboxAll<T> extends React.Component {\r\n\r\n    static propTypes = {...SelectionCheckboxAllProps};\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.defaultSelections = props.hideDefaultSelections ? [] : [{\r\n            key: 'all',\r\n            text: props.locale.selectAll,\r\n            onSelect: () => {},\r\n        }, {\r\n            key: 'invert',\r\n            text: props.locale.selectInvert,\r\n            onSelect: () => {},\r\n        }];\r\n\r\n        this.unsubscribe = () => {};\r\n\r\n        this.state = {\r\n            checked: this.getCheckState(props),\r\n            indeterminate: this.getIndeterminateState(props)\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.subscribe();\r\n    }\r\n\r\n    componentWillReceiveProps(nextProps) {\r\n        this.setCheckState(nextProps);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (this.unsubscribe) {\r\n            this.unsubscribe();\r\n        }\r\n    }\r\n\r\n    subscribe() {\r\n        const { store } = this.props;\r\n        this.unsubscribe = store.subscribe(() => {\r\n            this.setCheckState(this.props);\r\n        });\r\n    }\r\n\r\n    checkSelection(data, type, byDefaultChecked) {\r\n        const { store, getCheckboxPropsByItem, getRecordKey } = this.props;\r\n        // type should be 'every' | 'some'\r\n        if (type === 'every' || type === 'some') {\r\n            return (\r\n                byDefaultChecked\r\n                ? data[type]((item, i) => getCheckboxPropsByItem(item, i).defaultChecked)\r\n                : data[type]((item, i) => store.getState().selectedRowKeys.indexOf(getRecordKey(item, i)) >= 0)\r\n            );\r\n        }\r\n        return false;\r\n    }\r\n\r\n    setCheckState(props) {\r\n        const checked = this.getCheckState(props);\r\n        const indeterminate = this.getIndeterminateState(props);\r\n        if (checked !== this.state.checked) {\r\n            this.setState({ checked });\r\n        }\r\n        if (indeterminate !== this.state.indeterminate) {\r\n            this.setState({ indeterminate });\r\n        }\r\n    }\r\n\r\n    getCheckState(props) {\r\n        const { store, data } = props;\r\n        let checked;\r\n        if (!data.length) {\r\n            checked = false;\r\n        } else {\r\n            checked = store.getState().selectionDirty ? this.checkSelection(data, 'every', false)\r\n                : (this.checkSelection(data, 'every', false) || this.checkSelection(data, 'every', true));\r\n        }\r\n        return checked;\r\n    }\r\n\r\n    getIndeterminateState(props) {\r\n        const { store, data } = props;\r\n        let indeterminate;\r\n        if (!data.length) {\r\n            indeterminate = false;\r\n        } else {\r\n        indeterminate = store.getState().selectionDirty\r\n            ? (this.checkSelection(data, 'some', false) && !this.checkSelection(data, 'every', false))\r\n            : ((this.checkSelection(data, 'some', false) && !this.checkSelection(data, 'every', false)) ||\r\n                (this.checkSelection(data, 'some', true) && !this.checkSelection(data, 'every', true))\r\n            );\r\n        }\r\n        return indeterminate;\r\n    }\r\n\r\n    handleSelectAllChagne = (e) => {\r\n        let checked = e.target.checked;\r\n        this.props.onSelect(checked ? 'all' : 'removeAll', 0, null);\r\n    }\r\n\r\n    renderMenus(selections=[]) {\r\n        return selections.map((selection, index) => {\r\n            return (\r\n                <Menu.Item key={selection.key || index} >\r\n                    <div onClick={() => {this.props.onSelect(selection.key, index, selection.onSelect); }} >\r\n                        {selection.text}\r\n                    </div>\r\n                </Menu.Item>\r\n            );\r\n        });\r\n    }\r\n\r\n    render() {\r\n        const { disabled, prefixCls, selections, getPopupContainer } = this.props;\r\n        const { checked, indeterminate } = this.state;\r\n\r\n        let selectionPrefixCls = `${prefixCls}-selection`;\r\n\r\n        let customSelections = null;\r\n\r\n        if (selections) {\r\n            let newSelections = Array.isArray(selections) ? this.defaultSelections.concat(selections) : this.defaultSelections;\r\n\r\n        const menu = (\r\n            <Menu className={`${selectionPrefixCls}-menu`} selectedKeys={[]} >\r\n                {this.renderMenus(newSelections)}\r\n            </Menu>\r\n        );\r\n\r\n        customSelections = newSelections.length > 0 ? (\r\n            <Dropdown overlay={menu} getPopupContainer={getPopupContainer} >\r\n                <div className={`${selectionPrefixCls}-down`}>\r\n                    <Icon type=\"down\" />\r\n                </div>\r\n            </Dropdown>\r\n            ) : null;\r\n        }\r\n\r\n        return (\r\n            <div className={selectionPrefixCls}>\r\n                <Checkbox\r\n                    className={classNames({ [`${selectionPrefixCls}-select-all-custom`]: customSelections })}\r\n                    checked={checked}\r\n                    indeterminate={indeterminate}\r\n                    disabled={disabled}\r\n                    onChange={this.handleSelectAllChagne}\r\n                />\r\n                {customSelections}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n"]}