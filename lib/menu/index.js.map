{"version":3,"sources":["../../components/menu/index.js"],"names":["menuModeDS","Menu","props","getInlineCollapsed","inlineCollapsed","context","siderCollapsed","undefined","getRealMenuMode","switchModeFromInline","mode","getMenuOpenAnimation","menuMode","openAnimation","openTransitionName","menuOpenAnimation","leave","node","done","setState","handleOpenChange","openKeys","setOpenKeys","onOpenChange","handleClick","e","onClick","leaveAnimationExecutedWhencollapsed","inlineOpenKeys","state","defaultOpenKeys","jcMenuTheme","theme","nextProps","nextContext","prefixCls","length","querySelectorAll","className","menuClassName","menuProps","collapsedWidth","Component","Divider","Item","SubMenu","ItemGroup","defaultProps","propTypes","arrayOf","string","defaultSelectedKeys","bool","inlineIndent","number","oneOf","multiple","selectable","selectedKeys","style","object","subMenuCloseDelay","subMenuOpenDelay","func","onDeselect","onSelect","oneOfType","childContextTypes","contextTypes"],"mappings":"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","file":"index.js","sourcesContent":["/**\r\n * @file 二次封装rc-menu\r\n * @author chenyanhua\r\n * @version: 3.2.3\r\n */\r\nimport React from 'react';\r\n\r\nimport { findDOMNode } from 'react-dom';\r\n\r\nimport RcMenu, { Divider, ItemGroup } from 'rc-menu';\r\n\r\nimport PropTypes from 'prop-types';\r\n\r\nimport classNames from 'classnames';\r\n\r\nimport SubMenu from './SubMenu';\r\n\r\nimport Item from './MenuItem';\r\n\r\nimport animation from '../_util/openAnimation.js';\r\n\r\n// 菜单模式\r\nconst menuModeDS = ['vertical', 'vertical-left', 'vertical-right', 'horizontal', 'inline'];\r\n\r\nexport default class Menu extends React.Component {\r\n    static Divider = Divider;\r\n    static Item = Item;\r\n    static SubMenu = SubMenu;\r\n    static ItemGroup = ItemGroup;\r\n\r\n    static defaultProps = {\r\n        prefixCls: 'jc-menu',\r\n        className: '',\r\n        theme: 'light', // or dark\r\n    };\r\n\r\n    static propTypes = {\r\n        defaultOpenKeys: PropTypes.arrayOf(PropTypes.string), // 初始展开的 SubMenu 菜单项 key 数组\r\n        defaultSelectedKeys: PropTypes.arrayOf(PropTypes.string), // 初始选中的菜单项 key 数组\r\n        inlineCollapsed: PropTypes.bool, // 菜单是否收起状态(作用于所有的mode状态)\r\n        inlineIndent: PropTypes.number, // inline mode 菜单缩进宽度\r\n        mode: PropTypes.oneOf(menuModeDS), // 菜单模式\r\n        multiple: PropTypes.bool, // 是否允许多选\r\n        openKeys: PropTypes.arrayOf(PropTypes.string), // 当前展开的 SubMenu 菜单项 key 数组\r\n        selectable: PropTypes.bool, // 是否允许选中\r\n        selectedKeys: PropTypes.arrayOf(PropTypes.string), // 当前选中的菜单项 key 数组\r\n        style: PropTypes.object,\r\n        subMenuCloseDelay: PropTypes.number, // 用户鼠标离开子菜单后关闭延时，单位：秒\r\n        subMenuOpenDelay: PropTypes.number, // 用户鼠标进入子菜单后展开延时，单位：秒\r\n        theme: PropTypes.oneOf(['light', 'dark']), // 主题\r\n        onClick: PropTypes.func, // 点击 MenuItem 调用此函数\r\n        onDeselect: PropTypes.func, // 取消选中时调用，仅在 multiple 生效\r\n        onOpenChange: PropTypes.func, // SubMenu 展开/关闭的回调\r\n        onSelect: PropTypes.func, // 被选中时调用\r\n        openAnimation: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\r\n        openTransitionName: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\r\n        className: PropTypes.string,\r\n        prefixCls: PropTypes.string\r\n    };\r\n\r\n    // 向下传参\r\n    // siderCollapsed存在时，inlineCollapsed无效\r\n    // 因此，在SiderCollapsed存在的情况下，inlineCollapsed无效\r\n    static childContextTypes = {\r\n        inlineCollapsed: PropTypes.bool,\r\n        jcMenuTheme: PropTypes.string // 主题样式\r\n    };\r\n\r\n    /**\r\n     * 收起参数\r\n     * @variable siderCollapsed ： Sider是否收起\r\n     * @collapsedWidth ： Sider收起时宽度\r\n     */\r\n    static contextTypes = {\r\n        siderCollapsed: PropTypes.bool,\r\n        collapsedWidth: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n    };\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.switchModeFromInline = false;\r\n        this.leaveAnimationExecutedWhencollapsed = false; // inline 时当菜单收起时是否展示动画\r\n        this.inlineOpenKeys = []; // 备份openKeys数组\r\n\r\n        // 初始化展开菜单\r\n        this.state = {\r\n            openKeys: props.defaultOpenKeys || props.openKeys || []\r\n        };\r\n    }\r\n\r\n    // 向下传参\r\n    getChildContext() {\r\n        return {\r\n            inlineCollapsed: this.getInlineCollapsed(),\r\n            jcMenuTheme: this.props.theme\r\n        };\r\n    }\r\n\r\n    componentWillReceiveProps(nextProps, nextContext) {\r\n        const { prefixCls } = this.props;\r\n        if (this.props.mode === 'inline' && nextProps.mode !== 'inline') {\r\n            this.switchModeFromInline = true;\r\n        }\r\n        if ('openKeys' in nextProps) {\r\n            this.setState({ openKeys: nextProps.openKeys });\r\n            return;\r\n        }\r\n        if ((nextProps.inlineCollapsed && !this.props.inlineCollapsed) || (nextContext.siderCollapsed && !this.context.siderCollapsed)) {\r\n            this.switchModeFromInline = !!this.state.openKeys.length && !!findDOMNode(this).querySelectorAll(`.${prefixCls}-submenu-open`).length;\r\n            this.inlineOpenKeys = this.state.openKeys;\r\n            this.setState({ openKeys: [] });\r\n        }\r\n        if ((!nextProps.inlineCollapsed && this.props.inlineCollapsed) || (!nextContext.siderCollapsed && this.context.siderCollapsed)) {\r\n            this.setState({ openKeys: this.inlineOpenKeys });\r\n            this.inlineOpenKeys = [];\r\n        }\r\n    }\r\n    /**\r\n     * 菜单是否收起\r\n     * siderCollapsed存在时，inlineCollapsed无效\r\n     */\r\n    getInlineCollapsed = () => {\r\n        const { inlineCollapsed } = this.props;\r\n        if (this.context.siderCollapsed !== undefined) {\r\n            return this.context.siderCollapsed;\r\n        }\r\n        return inlineCollapsed;\r\n    }\r\n    getRealMenuMode = () => {\r\n        const inlineCollapsed = this.getInlineCollapsed();\r\n        if (this.switchModeFromInline && inlineCollapsed) {\r\n            return 'inline';\r\n        }\r\n        const { mode } = this.props;\r\n        return inlineCollapsed ? 'vertical' : mode;\r\n    }\r\n    getMenuOpenAnimation = (menuMode) => {\r\n        const { openAnimation, openTransitionName } = this.props;\r\n        let menuOpenAnimation = openAnimation || openTransitionName;\r\n        if (openAnimation === undefined && openTransitionName === undefined) {\r\n            switch (menuMode) {\r\n            case 'horizontal':\r\n                menuOpenAnimation = 'slide-up';\r\n                break;\r\n            case 'vertical':\r\n            case 'vertical-left':\r\n            case 'vertical-right':\r\n                // When mode switch from inline\r\n                // submenu should hide without animation\r\n                if (this.switchModeFromInline) {\r\n                    menuOpenAnimation = '';\r\n                    this.switchModeFromInline = false;\r\n                } else {\r\n                    menuOpenAnimation = 'zoom-big';\r\n                }\r\n                break;\r\n            case 'inline':\r\n                menuOpenAnimation = {\r\n                    ...animation,\r\n                    leave: (node, done) => animation.leave(node, () => {\r\n                        // Make sure inline menu leave animation finished before mode is switched\r\n                        this.switchModeFromInline = false;\r\n                        this.setState({});\r\n                        // when inlineCollapsed change false to true, all submenu will be unmounted,\r\n                        // so that we don't need handle animation leaving.\r\n                        if (this.getRealMenuMode() === 'vertical') {\r\n                            return;\r\n                        }\r\n                        done();\r\n                    })\r\n                };\r\n                break;\r\n            default:\r\n            }\r\n        }\r\n        return menuOpenAnimation;\r\n    }\r\n    setOpenKeys(openKeys) {\r\n        if (!('openKeys' in this.props)) {\r\n            this.setState({ openKeys });\r\n        }\r\n    }\r\n    /**\r\n     * SubMenu 展开/收起的回调\r\n     * @param openKeys 展开的菜单\r\n     */\r\n    handleOpenChange = (openKeys) => {\r\n        // 重新设置当前展开菜单\r\n        this.setOpenKeys(openKeys);\r\n\r\n        // 处理用户传递的回调\r\n        const { onOpenChange } = this.props;\r\n        if (onOpenChange) {\r\n            onOpenChange(openKeys);\r\n        }\r\n    }\r\n    /**\r\n     * menuItem click: 点击MenuItem时，关闭已经展开的菜单\r\n     * @param e mouse事件\r\n     */\r\n    handleClick = (e) => {\r\n        // 清空openKeys：关闭已经展开的菜单\r\n        this.handleOpenChange([]);\r\n\r\n        const { onClick } = this.props;\r\n        if (onClick) {\r\n            onClick(e);\r\n        }\r\n    }\r\n    render() {\r\n        const { prefixCls, className, theme } = this.props;\r\n        const menuMode = this.getRealMenuMode();\r\n        const menuOpenAnimation = this.getMenuOpenAnimation(menuMode);\r\n\r\n        const menuClassName = classNames(className, `${prefixCls}-${theme}`, {\r\n            [`${prefixCls}-inline-collapsed`]: this.getInlineCollapsed(),\r\n        });\r\n\r\n        const menuProps = {\r\n            openKeys: this.state.openKeys,\r\n            onOpenChange: this.handleOpenChange,\r\n            className: menuClassName,\r\n            mode: menuMode,\r\n        };\r\n\r\n        if (menuMode !== 'inline') {\r\n            // closing vertical popup submenu after click it\r\n            menuProps.onClick = this.handleClick;\r\n            menuProps.openTransitionName = menuOpenAnimation;\r\n        } else {\r\n            menuProps.openAnimation = menuOpenAnimation;\r\n        }\r\n\r\n        // https://github.com/ant-design/ant-design/issues/8587\r\n        const { collapsedWidth } = this.context;\r\n        if (\r\n            this.getInlineCollapsed() &&\r\n            (collapsedWidth === 0 || collapsedWidth === '0' || collapsedWidth === '0px')\r\n        ) {\r\n            return null;\r\n        }\r\n\r\n        return <RcMenu {...this.props} {...menuProps} />;\r\n    }\r\n}\r\n"]}