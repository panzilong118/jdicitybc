{"version":3,"sources":["../../components/spin/index.js"],"names":["React","SpinProps","prefixCls","string","className","spinning","bool","size","oneOf","wrapperClassName","indicator","node","delay","number","tip","style","object","Spin","props","isNestedPattern","children","renderIndicator","dotClassName","isValidElement","cloneElement","debounceTimeout","undefined","delayTimeout","state","setState","notCssAnimationSupported","nextProps","currentSpinning","clearTimeout","window","setTimeout","Number","isNaN","restProps","spinClassName","divProps","spinElement","animateClassName","containerClassName","Component","defaultProps","propTypes"],"mappings":"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","file":"index.js","sourcesContent":["/**\r\n * @author chenyanhua\r\n * @version 3.4.0\r\n */\r\nimport * as React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport classNames from 'classnames';\r\nimport Animate from 'rc-animate';\r\nimport omit from 'omit.js';\r\nimport isCssAnimationSupported from '../_util/isCssAnimationSupported';\r\n\r\nexport const SpinProps = {\r\n    prefixCls: PropTypes.string,\r\n    className: PropTypes.string,\r\n    spinning: PropTypes.bool, // 是否旋转\r\n    size: PropTypes.oneOf(['small', 'default', 'large']),\r\n    wrapperClassName: PropTypes.string, // 包装器的类属性\r\n    indicator: PropTypes.node, // 加载指示符\r\n    delay: PropTypes.number, // 延迟显示加载效果的时间（防止闪烁）\r\n    tip: PropTypes.string, // 当作为包裹元素时，可以自定义描述文案\r\n    style: PropTypes.object\r\n};\r\n\r\nexport default class Spin extends React.Component {\r\n    static defaultProps = {\r\n        prefixCls: 'jc-spin',\r\n        spinning: true,\r\n        size: 'default',\r\n        wrapperClassName: ''\r\n    };\r\n    static propTypes = {...SpinProps};\r\n\r\n    // static propTypes = {\r\n    //     prefixCls: PropTypes.string,\r\n    //     className: PropTypes.string,\r\n    //     spinning: PropTypes.bool, // 是否旋转\r\n    //     size: PropTypes.oneOf(['small', 'default', 'large']),\r\n    //     wrapperClassName: PropTypes.string, // 包装器的类属性\r\n    //     indicator: PropTypes.node, // 加载指示符\r\n    //     delay: PropTypes.number, // 延迟显示加载效果的时间（防止闪烁）\r\n    //     tip: PropTypes.string, // 当作为包裹元素时，可以自定义描述文案\r\n    //     style: PropTypes.object\r\n    // };\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.debounceTimeout = undefined;\r\n        this.delayTimeout = undefined;\r\n        this.state = {\r\n            spinning: props.spinning\r\n        };\r\n    }\r\n    componentDidMount() {\r\n        if (!isCssAnimationSupported()) {\r\n            // Show text in IE9\r\n            this.setState({\r\n                notCssAnimationSupported: true,\r\n            });\r\n        }\r\n    }\r\n    componentWillReceiveProps(nextProps) {\r\n        const currentSpinning = this.props.spinning;\r\n        const { spinning } = nextProps;\r\n        const { delay } = this.props;\r\n        if (this.debounceTimeout) {\r\n            clearTimeout(this.debounceTimeout);\r\n        }\r\n        if (currentSpinning && !spinning) {\r\n            this.debounceTimeout = window.setTimeout(() => this.setState({ spinning }), 200);\r\n            if (this.delayTimeout) {\r\n                clearTimeout(this.delayTimeout);\r\n            }\r\n        } else if (spinning && delay && !Number.isNaN(Number(delay))) {\r\n            if (this.delayTimeout) {\r\n                clearTimeout(this.delayTimeout);\r\n            }\r\n            this.delayTimeout = window.setTimeout(() => this.setState({ spinning }), delay);\r\n        } else {\r\n            this.setState({ spinning });\r\n        }\r\n    }\r\n    componentWillUnmount() {\r\n        if (this.debounceTimeout) {\r\n            clearTimeout(this.debounceTimeout);\r\n        }\r\n        if (this.delayTimeout) {\r\n            clearTimeout(this.delayTimeout);\r\n        }\r\n    }\r\n    /**\r\n     * 是否有子元素\r\n     * 有子元素时，指示整个子元素的加载状态\r\n     */\r\n    isNestedPattern = () => {\r\n        return !!(this.props && this.props.children);\r\n    }\r\n    /**\r\n     * 渲染组件：自定义组件或者默认组件\r\n     */\r\n    renderIndicator = () => {\r\n        const { prefixCls, indicator } = this.props;\r\n        // 加载符\r\n        const dotClassName = `${prefixCls}-dot`;\r\n        // 存在自定义加载符\r\n        if (React.isValidElement(indicator)) {\r\n            return React.cloneElement(indicator, {\r\n                className: classNames(indicator.props.className, dotClassName)\r\n            });\r\n        }\r\n        // 使用默认加载符\r\n        return (\r\n            <span className={classNames(dotClassName, `${prefixCls}-dot-spin`)}>\r\n                <i />\r\n                <i />\r\n                <i />\r\n                <i />\r\n            </span>\r\n        );\r\n    }\r\n    render() {\r\n        const { className, size, prefixCls, tip, wrapperClassName, ...restProps } = this.props;\r\n        const { spinning, notCssAnimationSupported } = this.state;\r\n\r\n        const spinClassName = classNames(prefixCls, {\r\n            [`${prefixCls}-sm`]: size === 'small',\r\n            [`${prefixCls}-lg`]: size === 'large',\r\n            [`${prefixCls}-spinning`]: spinning,\r\n            [`${prefixCls}-show-text`]: !!tip || notCssAnimationSupported,\r\n        }, className);\r\n        // fix https://fb.me/react-unknown-prop\r\n        const divProps = omit(restProps, [\r\n            'spinning',\r\n            'delay',\r\n            'indicator'\r\n        ]);\r\n        const spinElement = (\r\n            <div {...divProps} className={spinClassName}>\r\n                {this.renderIndicator()}\r\n                {tip ? <div className={`${prefixCls}-text`}>{tip}</div> : null}\r\n            </div>\r\n        );\r\n        // 如有子元素，包裹子元素，否则只返回加载符\r\n        if (this.isNestedPattern()) {\r\n            let animateClassName = `${prefixCls}-nested-loading`;\r\n            if (wrapperClassName) {\r\n                animateClassName = `${animateClassName} ${wrapperClassName}`;\r\n            }\r\n            const containerClassName = classNames({\r\n                [`${prefixCls}-container`]: true,\r\n                [`${prefixCls}-blur`]: spinning,\r\n            });\r\n            return (\r\n                <Animate\r\n                    {...divProps}\r\n                    component='div'\r\n                    className={animateClassName}\r\n                    style={null}\r\n                    transitionName='fade'\r\n                >\r\n                    {spinning && <div key='loading'>{spinElement}</div>}\r\n                    <div className={containerClassName} key='container'>\r\n                        {this.props.children}\r\n                    </div>\r\n                </Animate>\r\n            );\r\n        }\r\n        return spinElement;\r\n    }\r\n}\r\n"]}