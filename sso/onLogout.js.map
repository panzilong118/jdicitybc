{"version":3,"sources":["../src/sso/onLogout.js"],"names":["logouts","loginType","client","ApiClient","post","then","res","ds","data","domain","loginUrl","i","length","domainType","window","logoutSuccess","event","key","target","id","replace","flag","reutrnUrl","location","href","encodeURIComponent","html","Math","random","div","document","createElement","innerHTML","body","insertBefore","childNodes"],"mappings":";;;;;;kBACe,UAASA,OAAT,EAAiBC,SAAjB,EAA4B;AAC1C,KAAMC,SAAS,IAAIC,mBAAJ,EAAf;AACAD,QAAOE,IAAP,CAAY,iBAAZ,EAA+BC,IAA/B,CAAoC,UAASC,GAAT,EAAa;AAChD,MAAIC,KAAKD,IAAIE,IAAb;AAAA,MAAkBC,SAAS,IAA3B;AAAA,MAAgCC,WAAS,EAAzC;AACG,OAAI,IAAIC,IAAI,CAAZ,EAAeA,IAAIJ,GAAGK,MAAtB,EAA8BD,GAA9B,EAAmC;AAC/B,OAAGJ,GAAGI,CAAH,EAAME,UAAN,IAAkB,CAArB,EAAwB;AACtBJ,aAASF,GAAGI,CAAH,EAAMF,MAAf;AACD;AACD,OAAGF,GAAGI,CAAH,EAAME,UAAN,IAAkB,CAArB,EAAwB;AACtBH,aAAS,OAAT,IAAoBH,GAAGI,CAAH,EAAMF,MAAN,GAAa,8BAAjC;AACD;AACD,OAAGF,GAAGI,CAAH,EAAME,UAAN,IAAkB,CAArB,EAAwB;AACtBH,aAAS,QAAT,IAAqBH,GAAGI,CAAH,EAAMF,MAAN,GAAa,sCAAlC;AACD;AACD,OAAGF,GAAGI,CAAH,EAAME,UAAN,IAAkB,CAArB,EAAwB;AACtBH,aAAS,QAAT,IAAqBH,GAAGI,CAAH,EAAMF,MAAN,GAAa,gCAAlC;AACD;AACJ;AACDK,SAAOC,aAAP,GAAuB,UAASC,KAAT,EAAgB;AACrC,OAAIC,MAAMD,MAAME,MAAN,CAAaC,EAAb,CAAgBC,OAAhB,CAAwB,SAAxB,EAAkC,EAAlC,CAAV;AACA,OAAIC,OAAO,IAAX;AACArB,WAAQiB,GAAR,EAAa,CAAb,IAAkB,IAAlB;AACA,QAAI,IAAIN,CAAR,IAAcX,OAAd,EAAuB;AACrBqB,WAAOA,QAAQrB,QAAQW,CAAR,EAAW,CAAX,CAAf;AACD;AACD,OAAIW,YAAYrB,aAAW,QAAX,GAAqB,OAAKQ,MAAL,GAAY,2BAAjC,GAA8DK,OAAOS,QAAP,CAAgBC,IAA9F;AACA,OAAGH,IAAH,EAASP,OAAOS,QAAP,CAAgBC,IAAhB,GAAuB,OAAKd,SAAST,aAAW,OAApB,CAAL,GAAkC,cAAlC,GAAiDwB,mBAAmBH,SAAnB,CAAxE;AACV,GATD;AAUA,MAAGb,UAAQ,IAAX,EAAiB;AACf,OAAIiB,OAAO,EAAX;AACA,QAAK,IAAIf,CAAT,IAAcX,OAAd,EAAuB;AACrB0B,YAAO,wEAAsEf,KAAG,MAAH,GAAU,EAAV,GAAcA,IAAE,GAAtF,IAA4FF,MAA5F,GAAmGT,QAAQW,CAAR,EAAW,CAAX,CAAnG,GAAiH,MAAjH,GAAwHgB,KAAKC,MAAL,EAAxH,GAAsI,eAAtI,GAAsJjB,CAAtJ,GAAwJ,aAA/J;AACD;AACD,OAAIkB,MAAMC,SAASC,aAAT,CAAuB,KAAvB,CAAV;AACAF,OAAIG,SAAJ,GAAgBN,IAAhB;AACAI,YAASG,IAAT,CAAcC,YAAd,CAA2BL,GAA3B,EAAgCC,SAASG,IAAT,CAAcE,UAAd,CAAyB,CAAzB,CAAhC;AACD;AACJ,EAnCD;AAoCA,C;;AAvCD","file":"onLogout.js","sourcesContent":["import ApiClient from '../apiClient/ApiClient';\r\nexport default function(logouts,loginType) {\r\n\tconst client = new ApiClient();\r\n\tclient.post('passport/logout').then(function(res){\r\n\t\tvar ds = res.data,domain = null,loginUrl={};\r\n\t    for(var i = 0; i < ds.length; i++) {\r\n\t        if(ds[i].domainType==1) {\r\n\t          domain = ds[i].domain;\r\n\t        }\r\n\t        if(ds[i].domainType==5) {\r\n\t          loginUrl[\"login\"] = ds[i].domain+\"/service-passport-view/login\";\r\n\t        }\r\n\t        if(ds[i].domainType==8) {\r\n\t          loginUrl[\"mlogin\"] = ds[i].domain+\"/mobile-service-passport-view/signin\";\r\n\t        }\r\n\t        if(ds[i].domainType==9) {\r\n\t          loginUrl[\"plogin\"] = ds[i].domain+\"/passport-operating-view/login\";\r\n\t        }\r\n\t    }\r\n\t    window.logoutSuccess = function(event) {\r\n\t      var key = event.target.id.replace(\"logout-\",\"\");\r\n\t      var flag = true;\r\n\t      logouts[key][1] = true;\r\n\t      for(var i in  logouts) {\r\n\t        flag = flag && logouts[i][1];\r\n\t      }\r\n\t      var reutrnUrl = loginType==\"mlogin\"?(\"//\"+domain+\"/mobile-website-view/home\"):window.location.href\r\n\t      if(flag) window.location.href = \"//\"+loginUrl[loginType||\"login\"]+\"?return_url=\"+encodeURIComponent(reutrnUrl);\r\n\t    }\r\n\t    if(domain!=null) {\r\n\t      var html = \"\";\r\n\t      for (var i in logouts) {\r\n\t        html+= \"<iframe style='display:none' onload='logoutSuccess(event)' src='//\"+(i==\"main\"?\"\":(i+\".\"))+domain+logouts[i][0]+\"?_v=\"+Math.random()+\"' id='logout-\"+i+\"'></iframe>\"\r\n\t      }\r\n\t      var div = document.createElement(\"div\");\r\n\t      div.innerHTML = html;\r\n\t      document.body.insertBefore(div, document.body.childNodes[0]);\r\n\t    }\r\n\t})\r\n}\r\n"]}