{"version":3,"sources":["../../../src/components/TopTools/UserInfo/UserInfo.js"],"names":["ShopInfo","getLogin","getLoginAction","dispatch","props","state","username","avatarPicSrc","then","rs","code","setState","data","logouts","text","str","num","reg","i","test","buyer","logout","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kBAAA;;;;;;AAMA;;AAKA;;;;;AAJA;;;;AAEA;;AACA;;AAEA;;;;AACA;;;;;;AAEA;IAMqBA,Q,WALpB,yBACC;AAAA,SAAUC,wBAAV;AAAA,CADD,EAEC;AAAA,SAAY,+BAAmB,EAACC,8CAAD,EAAnB,EAAqCC,QAArC,CAAZ;AAAA,CAFD,C;;;AAMC,oBAAYC,KAAZ,EAAmB;AAAA;;AAAA,0IACXA,KADW;;AAEjB,UAAKC,KAAL,GAAa;AACXC,gBAAU,EADC;AAEXC,oBAAc;AAFH,KAAb;AAFiB;AAMlB;;AAED;;;;;;;yCAGqB;AAAA;;AACnB,WAAKH,KAAL,CAAWF,cAAX,GAA4BM,IAA5B,CAAiC,cAAM;AACrC,YAAIC,GAAGC,IAAH,IAAW,CAAf,EAAkB;AAClB,eAAKC,QAAL,CAAc;AACZL,oBAAUG,GAAGG,IAAH,CAAQN,QADN;AAEZC,wBAAcE,GAAGG,IAAH,CAAQL;AAFV,SAAd;AAID,OAND;AAOD;;AAED;;;;;;6BAGS;AACP,UAAMM,UAAU;AACd,oBAAY,CAAC,+BAAD,EAAkC,KAAlC,CADE;AAEd,gBAAQ,CAAC,mBAAD,EAAsB,KAAtB,CAFM;AAGd,iBAAS,CAAC,oBAAD,EAAuB,KAAvB,CAHK;AAId,gBAAQ,CAAC,sBAAD,EAAyB,KAAzB;AAJM,OAAhB;AAMA,8BAASA,OAAT,EAAkB,OAAlB;AACD;;AAED;;;;;;4BAGQC,I,EAAM;AACZ,UAAIC,MAAM,EAAV;AACA,UAAIC,MAAM,CAAV;AACA,UAAMC,MAAM,aAAZ;AACA,WAAK,IAAIC,CAAT,IAAcJ,IAAd,EAAoB;AAClB,YAAI,CAACG,IAAIE,IAAJ,CAASL,KAAKI,CAAL,CAAT,CAAL,EAAwB;AACtBF,iBAAO,CAAP;AACD,SAFD,MAEO;AACLA,iBAAO,CAAP;AACD;AACD,YAAIA,OAAO,CAAX,EAAc;AACZD,iBAAOD,KAAKI,CAAL,CAAP;AACD,SAFD,MAEO;AACLH,iBAAO,KAAP;AACA;AACD;AACF;AACD,aAAOA,GAAP;AACD;;;6BACQ;AAAA;;AACP,aACE;AAAA;AAAA,UAAK,WAAU,uBAAf;AACE;AAAA;AAAA;AAAI,eAAKV,KAAL,CAAWC,QAAf;AAAwB,0DAAM,MAAK,MAAX,EAAkB,WAAU,YAA5B;AAAxB,SADF;AAEE;AAAA;AAAA,YAAI,WAAU,qBAAd;AACE;AAAA;AAAA,cAAI,WAAU,UAAd;AACE;AAAA;AAAA,gBAAG,QAAO,QAAV,EAAmB,aAAW,KAAKF,KAAL,CAAWgB,KAAtB,+CAAnB;AACG,2BAAU,WADb;AAGI,mBAAKf,KAAL,CAAWE,YAAX,GACG,uCAAK,KAAK,KAAKF,KAAL,CAAWE,YAArB,EAAmC,KAAK,KAAKF,KAAL,CAAWC,QAAnD,GADH,GAEG;AAAA;AAAA;AAAG,gEAAM,MAAK,MAAX;AAAH;AALP;AADF,WADF;AAWE;AAAA;AAAA;AACE;AAAA;AAAA,gBAAG,QAAO,QAAV,EAAmB,aAAW,KAAKF,KAAL,CAAWgB,KAAtB,+CAAnB;AACG,2BAAU,WADb;AAAA;AAAA,aADF;AAGE,oDAAM,WAAU,iBAAhB,GAHF;AAIE;AAAA;AAAA,gBAAG,SAAS;AAAA,yBAAM,OAAKC,MAAL,EAAN;AAAA,iBAAZ;AAAA;AAAA;AAJF;AAXF;AAFF,OADF;AAsBD;;;EAhFmCC,gB;kBAAjBtB,Q","file":"UserInfo.js","sourcesContent":["/* *************************\r\n * @author: FengYan\r\n * @update: 20180206\r\n * @description:用户信息\r\n * ************************/\r\n\r\n/* ***********  基础组件  ************ */\r\nimport React, {Component} from 'react';\r\nimport {Icon} from 'jdcloudui';\r\nimport {bindActionCreators} from 'redux';\r\nimport {connect} from 'react-redux';\r\n/* ***********  自定义组件  ************ */\r\nimport getLogin, {getLoginAction} from './getLogin_redux';\r\nimport onLogout from '../../../sso/onLogout';\r\n\r\n/* ***********  redux  ************ */\r\n@connect(\r\n  state => (getLogin),\r\n  dispatch => bindActionCreators({getLoginAction}, dispatch)\r\n)\r\n\r\nexport default class ShopInfo extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      username: '',\r\n      avatarPicSrc: ''\r\n    };\r\n  }\r\n\r\n  /*\r\n   * 发送获取用户信息请求\r\n   * */\r\n  componentWillMount() {\r\n    this.props.getLoginAction().then(rs => {\r\n      if (rs.code != 0) return;\r\n      this.setState({\r\n        username: rs.data.username,\r\n        avatarPicSrc: rs.data.avatarPicSrc\r\n      });\r\n    });\r\n  }\r\n\r\n  /*\r\n   * 登出操作\r\n   * */\r\n  logout() {\r\n    const logouts = {\r\n      \"passport\": [\"/service-passport-view/logout\", false],\r\n      \"shop\": [\"/shop-view/logout\", false],\r\n      \"buyer\": [\"/buyer-view/logout\", false],\r\n      \"main\": [\"/website-view/logout\", false]\r\n    };\r\n    onLogout(logouts, \"login\");\r\n  }\r\n\r\n  /*\r\n   * 用户名截取\r\n   * */\r\n  strSize(text) {\r\n    let str = '';\r\n    let num = 0;\r\n    const reg = /[\\x00-\\xff]/;\r\n    for (let i in text) {\r\n      if (!reg.test(text[i])) {\r\n        num += 2;\r\n      } else {\r\n        num += 1;\r\n      }\r\n      if (num <= 6) {\r\n        str += text[i];\r\n      } else {\r\n        str += '...';\r\n        break;\r\n      }\r\n    }\r\n    return str;\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"down-menu f-ib deg180\">\r\n        <a>{this.state.username}<Icon type=\"down\" className=\"ml5 arrows\"/></a>\r\n        <ul className=\"down-menu-cont user\">\r\n          <li className=\"user-pic\">\r\n            <a target=\"_blank\" href={`//${this.props.buyer}/user-buyer-view/accountmanage/accountInfo`}\r\n               className=\"company-a\">\r\n              {\r\n                this.state.avatarPicSrc ?\r\n                  (<img src={this.state.avatarPicSrc} alt={this.state.username}/>) :\r\n                  (<p><Icon type=\"user\"/></p>)\r\n              }\r\n            </a>\r\n          </li>\r\n          <li>\r\n            <a target=\"_blank\" href={`//${this.props.buyer}/user-buyer-view/accountmanage/accountInfo`}\r\n               className=\"company-a\">账号管理</a>\r\n            <span className=\"vertical bg-eee\"/>\r\n            <a onClick={() => this.logout()}>退出</a></li>\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}"]}