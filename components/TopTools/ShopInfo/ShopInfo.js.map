{"version":3,"sources":["../../../src/components/TopTools/ShopInfo/ShopInfo.js"],"names":["cookie","Cookies","ShopInfo","getShopList","getShopListAction","dispatch","props","state","shopArr","shopName","then","rs","code","data","length","location","href","shop","get","defaultShopId","map","_item","shopId","companyName","setState","companyId","shopType","set","defaultDomain","disabled","push","setShopId","renderOptions","Component"],"mappings":"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","file":"ShopInfo.js","sourcesContent":["/* *************************\r\n * @author: FengYan\r\n * @update: 20180206\r\n * @description:店铺信息\r\n * ************************/\r\n\r\n/* ***********  基础组件  ************ */\r\nimport React, {Component} from 'react';\r\nimport {Icon} from 'jdcloudui';\r\nimport {bindActionCreators} from 'redux';\r\nimport {connect} from 'react-redux';\r\n\r\n/* ***********  自定义组件  ************ */\r\nimport getShopList, {getShopListAction} from './shopList_redux';\r\nimport Cookies from '../../../common/Cookies';\r\nconst cookie = new Cookies();\r\n/* ***********  redux  ************ */\r\n@connect(\r\n  state => (getShopList),\r\n  dispatch => bindActionCreators({getShopListAction}, dispatch)\r\n)\r\nexport default class ShopInfo extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      shopArr: [],\r\n      shopName: '请选择'\r\n    };\r\n  }\r\n\r\n  /*\r\n   * 发送获取店铺列表请求\r\n   * 判断cookie中是否有shopId，如果没有则调用defaultShopId方法设置\r\n   * 如果公司列表为空则跳转到注册公司引导页\r\n   * */\r\n  componentWillMount() {\r\n    this.props.getShopListAction().then(rs => {\r\n      if (rs.code != 0) return;\r\n\r\n      if (rs.data.length === 0) {\r\n        location.href = `//${this.props.shop}/user-shop-view/sellerinfo/defaultshophome`;\r\n      } else if (!cookie.get('shopId')) {\r\n        this.defaultShopId(rs.data[0]);\r\n      } else {\r\n        rs.data.map(_item => {\r\n          if (_item.shopId == cookie.get('shopId')) {\r\n            const shopName = `${_item.companyName}-${_item.shopName || '未命名'}`;\r\n            this.setState({shopName: shopName});\r\n          }\r\n        });\r\n        this.setState({shopArr: rs.data});\r\n      }\r\n    });\r\n  }\r\n\r\n  /*\r\n   * 通过onclick事件添加shopId到cookie中\r\n   * */\r\n  setShopId({shopId, companyId, shopType}) {\r\n    cookie.set('shopId', shopId, '', this.props.defaultDomain);\r\n    cookie.set('companyId', companyId, '', this.props.defaultDomain);\r\n    cookie.set('shopType', shopType, '', this.props.defaultDomain);\r\n  }\r\n\r\n  /*\r\n   * 设置默认cookie\r\n   * 跳转到获取菜单中间页\r\n   * */\r\n  defaultShopId({shopId, companyId, shopType}) {\r\n    cookie.set('shopId', shopId, '', this.props.defaultDomain);\r\n    cookie.set('companyId', companyId, '', this.props.defaultDomain);\r\n    cookie.set('shopType', shopType, '', this.props.defaultDomain);\r\n    if (this.props.disabled) {\r\n      location.href = `//${this.props.shop}/user-shop-view/shopdefaultmenu`;\r\n    }\r\n  }\r\n\r\n  /*\r\n   * 渲染店铺列表\r\n   * */\r\n  renderOptions() {\r\n    const shopArr = [];\r\n    this.state.shopArr.map(_item => {\r\n      shopArr.push(\r\n        <li key={_item.shopId}>\r\n          <a\r\n            onClick={() => this.setShopId(_item)}\r\n            href={`//${this.props.shop}/user-shop-view/shopdefaultmenu`}\r\n            className={cookie.get('shopId') == _item.shopId ? 'active' : ''}\r\n            title={`${_item.companyName}-${_item.shopName || '未命名'}`}\r\n          >\r\n            {`${_item.companyName}-${_item.shopName || '未命名'}`}\r\n          </a>\r\n        </li>\r\n      );\r\n    });\r\n    return shopArr;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"down-menu f-ib deg180\">\r\n        <a>{this.state.shopName}<Icon type=\"down\" className=\"ml5 arrows\"/></a>\r\n        <ul className=\"down-menu-cont select width380\">\r\n          {this.renderOptions()}\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}"]}