{"version":3,"sources":["../../../src/components/TopTools/ChooseLocal/ChooseLocal.js"],"names":["cookie","Cookies","ChooseLocal","getCitys","getCitysAction","dispatch","props","state","cityArr","disabled","areaName","visible","then","rs","code","setState","data","get","decodeURI","name","set","defaultDomain","encodeURI","setTimeout","citys","areaId","map","push","_city","id","setCookie","ab","renderCity","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kBAAA;;;;;;AAMA;;;AAMA;;;;;;;AALA;;;;AAEA;;AACA;;AAGA;;;;AACA;;;;;;AACA,IAAMA,SAAS,IAAIC,iBAAJ,EAAf;;AAEA;IAMqBC,W,WALpB,yBACC;AAAA,SAAUC,qBAAV;AAAA,CADD,EAEC;AAAA,SAAY,+BAAmB,EAACC,2CAAD,EAAnB,EAAqCC,QAArC,CAAZ;AAAA,CAFD,C;;;AAMC,uBAAYC,KAAZ,EAAmB;AAAA;;AAAA,gJACXA,KADW;;AAEjB,UAAKC,KAAL,GAAa;AACXC,eAAS,EADE;AAEXC,gBAAU,KAFC;AAGXC,gBAAU,KAHC;AAIXC,eAAS;AAJE,KAAb;AAFiB;AAQlB;;AAED;;;;;;;;yCAIqB;AAAA;;AACnB,WAAKL,KAAL,CAAWF,cAAX,GAA4BQ,IAA5B,CAAiC,cAAM;AACrC,YAAIC,GAAGC,IAAH,IAAW,CAAf,EAAkB;AAClB,eAAKC,QAAL,CAAc,EAACP,SAASK,GAAGG,IAAb,EAAd;AACD,OAHD;AAIA,UAAIhB,OAAOiB,GAAP,CAAW,UAAX,CAAJ,EAA4B;AAC1B,aAAKF,QAAL,CAAc;AACZL,oBAAUQ,UAAUlB,OAAOiB,GAAP,CAAW,UAAX,CAAV,CADE;AAEZN,mBAAS;AAFG,SAAd;AAID;AACF;;AAED;;;;;;;8BAIUG,I,EAAMK,I,EAAM;AAAA;;AACpBnB,aAAOoB,GAAP,CAAW,QAAX,EAAqBN,IAArB,EAA2B,EAA3B,EAA+B,KAAKR,KAAL,CAAWe,aAA1C;AACArB,aAAOoB,GAAP,CAAW,UAAX,EAAuBE,UAAUH,IAAV,CAAvB,EAAwC,EAAxC,EAA4C,KAAKb,KAAL,CAAWe,aAAvD;AACA,WAAKN,QAAL,CAAc,EAACN,UAAU,IAAX,EAAiBC,UAAUS,IAA3B,EAAiCR,SAAS,KAA1C,EAAd;AACAY,iBAAW;AAAA,eAAK,OAAKR,QAAL,CAAc,EAACN,UAAU,KAAX,EAAd,CAAL;AAAA,OAAX,EAAkD,GAAlD;AACD;;AAED;;;;;;+BAGWe,K,EAAO;AAAA;;AAChB;AACA,UAAMC,SAASzB,OAAOiB,GAAP,CAAW,QAAX,KAAwB,EAAvC;AACA,UAAMT,UAAU,EAAhB;AACAgB,YAAME,GAAN,CAAU,iBAAS;AACjBlB,gBAAQmB,IAAR,CACE;AAAA;AAAA,YAAI,KAAKC,MAAMC,EAAf;AACE;AAAA;AAAA;AACE,uBAAS;AAAA,uBAAM,OAAKC,SAAL,CAAeF,MAAMd,IAArB,EAA2Bc,MAAMT,IAAjC,CAAN;AAAA,eADX;AAEE,yBAAWM,WAAWG,MAAMd,IAAjB,GAAwB,QAAxB,GAAmC;AAFhD;AAIGc,kBAAMT,IAJT;AAIe,mBAAKZ,KAAL,CAAWwB;AAJ1B;AADF,SADF;AASD,OAVD;AAWA,aAAOvB,OAAP;AACD;;;6BAEQ;AACP,aACE;AAAA;AAAA,UAAK,WAAU,MAAf;AACE;AAAA;AAAA;AACE,qBAAS,KAAKD,KAAL,CAAWI,OADtB;AAEE,mBAAM,wDAFR;AAGE,oBAAQ,IAHV;AAIE,sBAAU;AAJZ;AAME;AAAA;AAAA,cAAK,WAAU,eAAf;AACE;AAAA;AAAA;AACG,mBAAKqB,UAAL,CAAgB,KAAKzB,KAAL,CAAWC,OAA3B;AADH;AADF;AANF,SADF;AAaE;AAAA;AAAA,YAAK,WAAU,WAAf;AACE;AAAA;AAAA;AAAG,4DAAM,MAAK,qCAAX,GAAH;AAAsD,iBAAKD,KAAL,CAAWG;AAAjE,WADF;AAEG,WAAC,KAAKH,KAAL,CAAWE,QAAZ,IACC;AAAA;AAAA,cAAI,WAAU,0BAAd;AACG,iBAAKuB,UAAL,CAAgB,KAAKzB,KAAL,CAAWC,OAA3B;AADH;AAHJ;AAbF,OADF;AAwBD;;;EArFsCyB,gB;kBAApB/B,W","file":"ChooseLocal.js","sourcesContent":["/* *************************\r\n * @author: FengYan\r\n * @update: 20180206\r\n * @description:选择收货地\r\n * ************************/\r\n\r\n/* ***********  基础组件  ************ */\r\nimport React, {Component} from 'react';\r\nimport {Icon, Modal} from 'jdcloudui';\r\nimport {bindActionCreators} from 'redux';\r\nimport {connect} from 'react-redux';\r\n\r\n/* ***********  自定义组件  ************ */\r\nimport getCitys, {getCitysAction} from './citys_redux';\r\nimport Cookies from '../../../common/Cookies';\r\nconst cookie = new Cookies();\r\n\r\n/* ***********  redux  ************ */\r\n@connect(\r\n  state => (getCitys),\r\n  dispatch => bindActionCreators({getCitysAction}, dispatch)\r\n)\r\n\r\nexport default class ChooseLocal extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      cityArr: [],\r\n      disabled: false,\r\n      areaName: '请选择',\r\n      visible: true\r\n    };\r\n  }\r\n\r\n  /*\r\n   * 发送获取地市列表讲求\r\n   * 根据cookie中是否有areaName控制地域选择弹框\r\n   * */\r\n  componentWillMount() {\r\n    this.props.getCitysAction().then(rs => {\r\n      if (rs.code != 0) return;\r\n      this.setState({cityArr: rs.data});\r\n    });\r\n    if (cookie.get('areaName')) {\r\n      this.setState({\r\n        areaName: decodeURI(cookie.get('areaName')),\r\n        visible: false\r\n      });\r\n    }\r\n  }\r\n\r\n  /*\r\n   * 设置areaId和areaName到cookie中\r\n   * setTimeout方法控制地域选择下拉列表\r\n   * */\r\n  setCookie(code, name) {\r\n    cookie.set('areaId', code, '', this.props.defaultDomain);\r\n    cookie.set('areaName', encodeURI(name), '', this.props.defaultDomain);\r\n    this.setState({disabled: true, areaName: name, visible: false});\r\n    setTimeout(_ => this.setState({disabled: false}), 100);\r\n  }\r\n\r\n  /*\r\n   * 渲染地市列表\r\n   * */\r\n  renderCity(citys) {\r\n    // 一级地市列表渲染\r\n    const areaId = cookie.get('areaId') || '';\r\n    const cityArr = [];\r\n    citys.map(_city => {\r\n      cityArr.push(\r\n        <li key={_city.id}>\r\n          <span\r\n            onClick={() => this.setCookie(_city.code, _city.name)}\r\n            className={areaId === _city.code ? 'active' : ''}\r\n          >\r\n            {_city.name}{this.state.ab}\r\n          </span>\r\n        </li>);\r\n    });\r\n    return cityArr;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"f-ib\">\r\n        <Modal\r\n          visible={this.state.visible}\r\n          title=\"请选择你的收货地区\"\r\n          footer={null}\r\n          closable={false}\r\n        >\r\n          <div className=\"unChooseLocal\">\r\n            <ul>\r\n              {this.renderCity(this.state.cityArr)}\r\n            </ul>\r\n          </div>\r\n        </Modal>\r\n        <div className=\"down-menu\">\r\n          <a><Icon type=\"new-gps f-fl f-fs26 mt2 active-text\"/>{this.state.areaName}</a>\r\n          {!this.state.disabled && (\r\n            <ul className=\"down-menu-cont localCont\">\r\n              {this.renderCity(this.state.cityArr)}\r\n            </ul>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}"]}