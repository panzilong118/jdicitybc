{"version":3,"sources":["../../../src/components/TopTools/CompanyInfo/CompanyInfo.js"],"names":["cookie","Cookies","CompanyInfo","getCompanyList","getCompanyListAction","dispatch","props","state","companyArr","companyName","then","rs","code","data","length","location","href","buyer","get","defaultCompanyId","map","_item","companyId","setState","set","defaultDomain","disabled","push","setCompanyId","renderOptions","Component"],"mappings":"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","file":"CompanyInfo.js","sourcesContent":["/* *************************\r\n * @author: FengYan\r\n * @update: 20180206\r\n * @description:公司信息\r\n * ************************/\r\n\r\n/* ***********  基础组件  ************ */\r\nimport React, {Component} from 'react';\r\nimport {Icon} from 'jdcloudui';\r\nimport {bindActionCreators} from 'redux';\r\nimport {connect} from 'react-redux';\r\n\r\n/* ***********  自定义组件  ************ */\r\nimport getCompanyList, {getCompanyListAction} from './companyList_redux';\r\nimport Cookies from '../../../common/Cookies';\r\nconst cookie = new Cookies();\r\n/* ***********  redux  ************ */\r\n@connect(\r\n  state => (getCompanyList),\r\n  dispatch => bindActionCreators({getCompanyListAction}, dispatch)\r\n)\r\nexport default class CompanyInfo extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      companyArr: [],\r\n      companyName: '请选择'\r\n    };\r\n  }\r\n\r\n  /*\r\n   * 发送获取公司列表请求\r\n   * 判断cookie中是否有companyId，如果没有则调用defaultCompanyId方法设置\r\n   * 如果公司列表为空则跳转到注册公司引导页\r\n   * */\r\n  componentWillMount() {\r\n    this.props.getCompanyListAction().then(rs => {\r\n      if (rs.code != 0) return;\r\n      if (rs.data.length === 0) {\r\n        location.href = `//${this.props.buyer}/user-buyer-view/accountmanage/addcompany?type=1`;\r\n      } else if (!cookie.get('companyId')) {\r\n        this.defaultCompanyId(rs.data[0]);\r\n      }else{\r\n        rs.data.map(_item=>{\r\n          if (_item.companyId == cookie.get('companyId')) {\r\n            this.setState({companyName:_item.companyName});\r\n          }\r\n        });\r\n        this.setState({companyArr: rs.data});\r\n      }\r\n    });\r\n  }\r\n\r\n  /*\r\n   * 通过onclick事件添加companyId到cookie中\r\n   * */\r\n  setCompanyId({companyId}) {\r\n    cookie.set('companyId', companyId, '', this.props.defaultDomain);\r\n  }\r\n\r\n  /*\r\n   * 设置默认cookie\r\n   * 跳转到获取菜单中间页\r\n   * */\r\n  defaultCompanyId({companyId}) {\r\n    cookie.set('companyId', companyId, '', this.props.defaultDomain);\r\n    if (this.props.disabled) {\r\n      location.href = `//${this.props.buyer}/user-buyer-view/defaultbuyermenu`;\r\n    }\r\n  }\r\n\r\n  /*\r\n   * 渲染公司列表\r\n   * */\r\n  renderOptions() {\r\n    const companyArr = [];\r\n    this.state.companyArr.map(_item => {\r\n      companyArr.push(\r\n        <li key={_item.companyId}>\r\n          <a\r\n            onClick={() => this.setCompanyId({companyId: _item.companyId})}\r\n            href={`//${this.props.buyer}/user-buyer-view/defaultbuyermenu`}\r\n            className={cookie.get('companyId') == _item.companyId ? 'active' : ''}\r\n            title={_item.companyName}\r\n          >\r\n            {_item.companyName || '未命名'}\r\n          </a>\r\n        </li>\r\n      );\r\n    });\r\n    return companyArr;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"down-menu f-ib deg180\">\r\n        <a>{this.state.companyName}<Icon type=\"down\" className=\"ml5 arrows\"/></a>\r\n        <ul className=\"down-menu-cont select width380\">\r\n          {this.renderOptions()}\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}"]}