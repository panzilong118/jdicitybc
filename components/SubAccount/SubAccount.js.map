{"version":3,"sources":["../../src/components/SubAccount/SubAccount.js"],"names":["subaccountmanageUrl","rolemanageUrl","Buyer","props","context","state","menus","icon","logo","client","ApiClient","form","get","params","then","res","code","data","tmp","result","reformData","setState","err","length","i","push","reformUnit","unit","id","name","href","target","children","url","buyerMenuSearch","getWebsiteConfig","minHeight","window","document","body","clientHeight","location","referer","referrer","userLogo","o","menu","getHref","horizontalMenu","map","rest","subMenu","hKey","vKey","openKey","vName","urlMatch","tmpOpenKey","q","j","vMenu","n","sMenu","menuUrl","route","verticalMenu","Component","propTypes","PropTypes","object","isRequired"],"mappings":"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","file":"SubAccount.js","sourcesContent":["import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Link} from 'react-router';\t//链接跳转，相当于a标签\r\nimport BuyerHeader from '../Buyer/Header/Header';\r\nimport BuyerSider from '../Buyer/Sider/Sider';\r\nimport '../Buyer/style/buyer.css';\r\nimport TopTools from '../TopTools/TopTools';\r\nimport ApiClient from '../../apiClient/ApiClient';\r\nimport Helmet from 'react-helmet';\r\nconst subaccountmanageUrl = '/subaccount-buyer-view/subaccountmanage';\r\nconst rolemanageUrl = '/subaccount-buyer-view/rolemanage';\r\nexport default class Buyer extends Component {\r\n  static propTypes = {\r\n    children: PropTypes.object.isRequired\r\n  };\r\n\r\n  constructor(props, context) {\r\n    super(props, context);\r\n    this.state = {\r\n      menus: [],\r\n      icon:\"\",\r\n      logo:''\r\n    }\r\n  }\r\n\r\n  //------------------动态获取菜单begin-------------------------------------\r\n  buyerMenuSearch(){\r\n    var client = new ApiClient();\r\n    let form = null;\r\n    client.get('/authority-service/mall/resource/queryResourceMenuByBuyId',{params:form})\r\n      .then(\r\n        (res) => {\r\n          if(res.code==0 && res.data){\r\n            let tmp = res.data;\r\n            let result = this.reformData(tmp);\r\n            this.setState({\r\n              menus: result,\r\n            })\r\n          }\r\n        },\r\n        (err) => {\r\n        }\r\n      )\r\n  }\r\n\r\n  reformData(data) {\r\n    let result = [];\r\n    if(data && data.length){\r\n      for(let i in data){\r\n        result.push(this.reformUnit(data[i]));\r\n      }\r\n    }else{}\r\n    return result;\r\n  }\r\n\r\n  reformUnit(data){\r\n    let unit = {id:'',name:'',href:'',target:'',children:[]};\r\n    unit.id = data.id+'';\r\n    unit.name = data.name;\r\n    unit.href = data.url;\r\n    unit.target = data.target?data.target:'_self';\r\n    unit.icon = data.icon;\r\n    if(data && data.children && data.children.length>0){\r\n      for(let i in data.children){\r\n        unit.children.push(this.reformUnit(data.children[i]))\r\n      }\r\n    }else{\r\n      delete unit['children'];\r\n    }\r\n    return unit;\r\n  }\r\n  //------------------动态获取菜单end-------------------------------------\r\n\r\n  componentWillMount() {\r\n    this.buyerMenuSearch();\r\n    this.getWebsiteConfig();\r\n    this.minHeight = typeof window !== 'undefined' ? document.body.clientHeight - 64 : 580;\r\n    this.location = typeof window !== 'undefined' ? window.location.href : \"\";\r\n    this.referer = typeof document !== 'undefined' ? document.referrer : \"\";\r\n  }\r\n  //------------------获取ICON--------------------------------------------\r\n  getWebsiteConfig() {\r\n    var client = new ApiClient();\r\n    client.get('/platform-service/mallInfo/getMallInfo')\r\n      .then(\r\n        (res) => {\r\n          if(res.code==0 && res.data){\r\n            this.setState({icon:res.data.icon,logo:res.data.userLogo})\r\n          }\r\n        },\r\n        (err) => {\r\n\r\n        }\r\n      )\r\n  }\r\n  //----------------------------------------------------------------------\r\n  getHref(o) {\r\n    if(o && o.length){\r\n      for (var i = 0; i < o.length; i++) {\r\n        var menu = o[i];\r\n        if (menu.href && menu.href != \"\") {\r\n          return menu.href;\r\n        } else if (menu.children && menu.children.length) {\r\n          return this.getHref(menu.children)\r\n        } else {\r\n          return \"\";\r\n        }\r\n      }\r\n    }else{}\r\n    return \"\";\r\n  }\r\n\r\n  horizontalMenu(o) {\r\n    const horizontalMenu = [];\r\n    if(o && o.length && o.length > 0){\r\n      o.map((menu) => {\r\n        const {children, ...rest} = menu;\r\n        rest.href = rest.href && rest.href != \"\" ? rest.href : this.getHref(children);\r\n        horizontalMenu.push(rest);\r\n      });\r\n    }\r\n    return horizontalMenu;\r\n  }\r\n\r\n  urlMatch(location,menu){\r\n    // menu.href:/dfsd/sdfs  数据库中返回的数据\r\n    // location:优先为menuUrl，其次this.location\r\n    // menuUrl优先匹配\r\n    // if ( menu && menu.href && (menu.href == subaccountmanageUrl || menu.href == rolemanageUrl)){\r\n      if(location!='' && menu && menu.href && menu.href!=''){\r\n        if(location==subaccountmanageUrl){\r\n          if(location == menu.href && menu.name == '账号管理'){\r\n            return true;\r\n          }\r\n        }else{\r\n          if(location == menu.href){\r\n            return true;\r\n          }\r\n        }\r\n      }\r\n    // }\r\n    return false;\r\n  }\r\n\r\n  verticalMenu(o, location) {\r\n    var subMenu = [];\r\n    var hKey = 0;\r\n    var vKey = 0;\r\n    var openKey = [];\r\n    var vName = \"\";\r\n    if(o && o.length && o.length > 0){\r\n      for (var i = 0; i < o.length; i++) {\r\n        var menu = o[i];\r\n        if (menu.href && menu.href != \"\" && this.urlMatch(location,menu)) {\r\n          subMenu = menu.children;\r\n          hKey = menu.id;\r\n          let tmpOpenKey=[];\r\n          for(let q in menu.children){\r\n            tmpOpenKey.push(menu.children[q].id+'');\r\n          }\r\n          openKey=tmpOpenKey;\r\n        } else if (menu.children && menu.children.length) {\r\n          for (var j = 0; j < menu.children.length; j++) {\r\n            var vMenu = menu.children[j];\r\n            if (vMenu.href && vMenu.href != \"\" && this.urlMatch(location,vMenu)) {\r\n              subMenu = menu.children;\r\n              // subMenu = vMenu.children;\r\n              hKey = menu.id;\r\n              vKey = vMenu.id;\r\n              vName = vMenu.name;\r\n            } else if (vMenu.children && vMenu.children.length) {\r\n              for (var n = 0; n < vMenu.children.length; n++) {\r\n                var sMenu = vMenu.children[n];\r\n                if (sMenu.href && sMenu.href != \"\" && this.urlMatch(location,sMenu)) {\r\n                  subMenu = vMenu.children;\r\n                  hKey = menu.id;\r\n                  vKey = sMenu.id;\r\n                  vName = sMenu.name;\r\n                  openKey.push(vMenu.id);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return {subMenu, hKey, openKey, vKey,vName}\r\n  }\r\n\r\n  render() {\r\n    const horizontalMenu = this.horizontalMenu(this.state.menus);\r\n    let menuUrl =\r\n      this.props.children &&\r\n      this.props.children.props &&\r\n      this.props.children.props.route &&\r\n      this.props.children.props.route.menuUrl;\r\n    let verticalMenu = { subMenu:[], hKey:'0', openKey:'0', vKey:[],} ;\r\n    if(menuUrl){\r\n      verticalMenu = this.verticalMenu(this.state.menus, menuUrl);\r\n    }else{\r\n      verticalMenu = this.verticalMenu(this.state.menus, this.location);\r\n    }\r\n    if (verticalMenu.subMenu && verticalMenu.subMenu.length && verticalMenu.subMenu.length == 0) {\r\n      verticalMenu = this.verticalMenu(this.state.menus, this.referer || \"\");\r\n    }\r\n    const {hKey,vName, ...rest} = verticalMenu;\r\n    return (\r\n      <div>\r\n        <Helmet>\r\n          <title>{vName}</title>\r\n          <link rel=\"icon\" href={this.state.icon} mce_href={this.state.icon} type=\"image/x-icon\" />\r\n        </Helmet>\r\n        <TopTools />\r\n        <BuyerHeader menus={horizontalMenu} selectKey={hKey} logo={this.state.logo} type=\"subaccount\"/>\r\n        <div className=\"buyer-framework-body-container\">\r\n          <div className='buyer-framework-body-container-left'>\r\n            <BuyerSider {...rest} />\r\n          </div>\r\n          <div className='buyer-framework-body-container-right' style={{minHeight: this.minHeight + \"px\"}}>\r\n            {this.props.children}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}"]}