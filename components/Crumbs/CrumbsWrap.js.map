{"version":3,"sources":["../../src/components/Crumbs/CrumbsWrap.js"],"names":["CrumbsWrap","queryResourceMenuByBuyId","queryResourceMenuBySellerId","queryResourceMenuByOwnerType","queryResourceMenuByCompanyId","queryResourceMenuByPuserId","dispatch","props","context","state","menuData","willMenuData","pathname","host","domain","window","location","slice","menuType","shopType","getCookieByArray","then","result","code","setState","data","ownerType","name","document","cookies","cookie","split","c","i","length","replace","flatten","reduce","arr","url","pid","children","concat","crumbsObj","obj","v","find","item","index","getMenus","menu","pushMenu","unshift","renderMenu","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;AACA;;AAEA;;;;IAOqBA,U,WALpB,yBACC;AAAA,SAAU,EAAV;AAAA,CADD,EAEC;AAAA,SAAY,+BAAmB,EAACC,0DAAD,EAA2BC,gEAA3B,EAAwDC,kEAAxD,EAAsFC,kEAAtF,EAAoHC,8DAApH,EAAnB,EAAoKC,QAApK,CAAZ;AAAA,CAFD,C;;;AAMC,sBAAYC,KAAZ,EAAkBC,OAAlB,EAA0B;AAAA;;AAAA,8IAClBD,KADkB,EACZC,OADY;;AAExB,UAAKC,KAAL,GAAa;AACXC,gBAAU,EADC;AAEXC,oBAAcJ,MAAMG;AAFT,KAAb;AAIA,UAAKE,QAAL,GAAgB,EAAhB;AACA,UAAKC,IAAL,GAAY,EAAZ;AAPwB;AAQzB;;;;wCAEmB;AAAA;;AAClB,UAAIC,SAASC,OAAOC,QAAP,CAAgBH,IAAhB,CAAqBI,KAArB,CAA2B,CAA3B,EAA8B,CAA9B,CAAb;AACA,WAAKL,QAAL,GAAgBG,OAAOC,QAAP,CAAgBJ,QAAhC;AACA,WAAKC,IAAL,GAAYE,OAAOC,QAAP,CAAgBH,IAA5B;AACA,UAAIK,WAAW,KAAKX,KAAL,CAAWW,QAA1B;AACA,UAAIC,WAAW,KAAKC,gBAAL,CAAsB,UAAtB,CAAf;AACA,UAAGF,aAAa,eAAhB,EAAgC;AAC9B,aAAKX,KAAL,CAAWH,4BAAX,GAA0CiB,IAA1C,CACE,kBAAU;AACR,cAAGC,OAAOC,IAAP,IAAe,CAAlB,EAAqB;AACnB,mBAAKC,QAAL,CAAc,EAACd,UAAUY,OAAOG,IAAlB,EAAd;AACD;AACF,SALH;AAOA;AACD;AACD,UAAGN,YAAY,CAAf,EAAkB;AAChB,aAAKZ,KAAL,CAAWJ,4BAAX,CAAwC,EAACuB,WAAW,cAAZ,EAAxC,EAAqEL,IAArE,CACE,kBAAU;AACR,cAAGC,OAAOC,IAAP,IAAe,CAAlB,EAAqB;AACnB,mBAAKC,QAAL,CAAc,EAACd,UAAUY,OAAOG,IAAlB,EAAd;AACD;AACF,SALH;AAOA;AACD;AACD,UAAGX,WAAW,MAAd,EAAsB;AACpB,aAAKP,KAAL,CAAWN,wBAAX,GAAsCoB,IAAtC,CACE,kBAAU;AACR,cAAGC,OAAOC,IAAP,IAAe,CAAlB,EAAqB;AACnB,mBAAKC,QAAL,CAAc,EAACd,UAAUY,OAAOG,IAAlB,EAAd;AACD;AACF,SALH;AAOD;AACD,UAAGX,WAAW,MAAd,EAAsB;AACpB,SAACK,YAAY,CAAZ,IAAiBA,YAAY,CAA9B,KAAoC,KAAKZ,KAAL,CAAWL,2BAAX,CAAuC,EAACiB,kBAAD,EAAvC,EAAmDE,IAAnD,CAClC,kBAAU;AACR,cAAGC,OAAOC,IAAP,IAAe,CAAlB,EAAqB;AACnB,mBAAKC,QAAL,CAAc,EAACd,UAAUY,OAAOG,IAAlB,EAAd;AACD;AACF,SALiC,CAApC;AAOD;AACD,UAAGX,WAAW,MAAd,EAAsB;AACpB,aAAKP,KAAL,CAAWF,0BAAX,GAAwCgB,IAAxC,CACE,kBAAU;AACR,cAAGC,OAAOC,IAAP,IAAe,CAAlB,EAAqB;AACnB,mBAAKC,QAAL,CAAc,EAACd,UAAUY,OAAOG,IAAlB,EAAd;AACD;AACF,SALH;AAOD;AACF;;AAED;;;;qCACiBE,I,EAAK;AACpB,UAAG,OAAOC,QAAP,KAAoB,WAAvB,EAAmC;AACjC,YAAIC,UAAUD,SAASE,MAAT,CAAgBC,KAAhB,CAAsB,GAAtB,CAAd;AACA,YAAIC,CAAJ;AACA,aAAI,IAAIC,IAAE,CAAV,EAAaA,IAAEJ,QAAQK,MAAvB,EAAgCD,GAAhC,EAAoC;AAClCD,cAAIH,QAAQI,CAAR,EAAWF,KAAX,CAAiB,GAAjB,CAAJ;AACA,cAAIC,EAAE,CAAF,EAAKG,OAAL,CAAa,GAAb,EAAkB,EAAlB,KAAyBR,IAA7B,EAAmC;AACjC,mBAAOK,EAAE,CAAF,CAAP;AACD;AACF;AACF,OATD,MASK;AACH,eAAO,IAAP;AACD;AACF;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;+BACWP,I,EAAM;AAAA;;AACf,UAAG,KAAKhB,KAAL,CAAWE,YAAd,EAA4B,OAAO,KAAKF,KAAL,CAAWE,YAAlB;AAC5B,UAAMyB,UAAU,SAAVA,OAAU,CAACX,IAAD,EAAU;AACxBA,eAAOA,QAAQ,EAAf;AACA,eAAOA,KAAKY,MAAL,CAAY,UAACC,GAAD;AAAA,cAAOX,IAAP,QAAOA,IAAP;AAAA,cAAaY,GAAb,QAAaA,GAAb;AAAA,cAAkBhB,IAAlB,QAAkBA,IAAlB;AAAA,cAAwBiB,GAAxB,QAAwBA,GAAxB;AAAA,mCAA6BC,QAA7B;AAAA,cAA6BA,QAA7B,iCAAwC,EAAxC;AAAA,iBACjBH,IAAII,MAAJ,CAAW,CAAC,EAACf,UAAD,EAAOY,QAAP,EAAYhB,UAAZ,EAAkBiB,QAAlB,EAAD,CAAX,EAAqCJ,QAAQK,QAAR,CAArC,CADiB;AAAA,SAAZ,EACoD,EADpD,CAAP;AAED,OAJD;AAKA,UAAMH,MAAMF,QAAQX,IAAR,CAAZ;AACA,UAAMkB,YAAYL,IAAID,MAAJ,CAAW,UAACO,GAAD,EAAMC,CAAN,EAAY;AACvCD,YAAIC,EAAEtB,IAAN,IAAcsB,CAAd;AACA,eAAOD,GAAP;AACD,OAHiB,EAGf,EAHe,CAAlB;AAIA,UAAIrB,OAAO,CAACe,IAAIQ,IAAJ,CAAS,UAACC,IAAD,EAAOC,KAAP,EAAcvB,IAAd;AAAA,eAAuBsB,KAAKR,GAAL,IAAY,OAAK3B,QAAxC;AAAA,OAAT,KAA8D,EAA/D,EAAmEW,IAA9E;AACA,aAAO,KAAK0B,QAAL,CAAcN,SAAd,EAAyBpB,IAAzB,CAAP;AACD;;;6BAEQqB,G,EAAKrB,I,EAAM;AAClB,UAAM2B,OAAO,EAAb;AACA,UAAG,CAAC3B,IAAJ,EAAU,OAAO2B,IAAP;AACV,UAAMC,WAAW,SAAXA,QAAW,CAAC5B,IAAD,EAAU;AACzB2B,aAAKE,OAAL,CAAaR,IAAIrB,IAAJ,CAAb;AACA,YAAGqB,IAAIrB,IAAJ,EAAUiB,GAAV,IAAiB,CAApB,EAAsB;AACpBW,mBAASP,IAAIA,IAAIrB,IAAJ,EAAUiB,GAAd,EAAmBjB,IAA5B;AACD;AACF,OALD;AAMA4B,eAAS5B,IAAT;AACA,aAAO2B,IAAP;AACD;;;6BAES;AACR,UAAMA,OAAO,KAAKzC,KAAL,CAAWC,QAAX,CAAoBwB,MAApB,IAA8B,KAAKmB,UAAL,CAAgB,KAAK5C,KAAL,CAAWC,QAA3B,CAA3C;AACA,aAAO;AAAA;AAAA,UAAK,WAAU,eAAf;AACH,sCAAC,sBAAD,IAAc,MAAMwC,IAApB;AADG,OAAP;AAGD;;;EArLqCI,gB;kBAAnBtD,U","file":"CrumbsWrap.js","sourcesContent":["import React, {Component} from 'react';\r\nimport JcBreadCrumb from '../JcBreadCrumb/JcBreadCrumb';\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\n\r\nimport {queryResourceMenuByBuyId, queryResourceMenuBySellerId, queryResourceMenuByOwnerType, queryResourceMenuByCompanyId, queryResourceMenuByPuserId} from './redux';\r\n\r\n@connect(\r\n  state => ({}),\r\n  dispatch => bindActionCreators({queryResourceMenuByBuyId, queryResourceMenuBySellerId, queryResourceMenuByOwnerType, queryResourceMenuByCompanyId, queryResourceMenuByPuserId}, dispatch)\r\n)\r\n\r\nexport default class CrumbsWrap extends Component{\r\n  constructor(props,context){\r\n    super(props,context);\r\n    this.state = {\r\n      menuData: [],\r\n      willMenuData: props.menuData\r\n    }\r\n    this.pathname = '';\r\n    this.host = '';\r\n  }\r\n\r\n  componentDidMount() {\r\n    let domain = window.location.host.slice(0, 4);\r\n    this.pathname = window.location.pathname;\r\n    this.host = window.location.host;\r\n    let menuType = this.props.menuType;\r\n    let shopType = this.getCookieByArray('shopType');\r\n    if(menuType === 'companymanage'){\r\n      this.props.queryResourceMenuByCompanyId().then(\r\n        result => {\r\n          if(result.code == 0) {\r\n            this.setState({menuData: result.data});\r\n          }\r\n        }\r\n      )\r\n      return;\r\n    }\r\n    if(shopType == 4) {\r\n      this.props.queryResourceMenuByOwnerType({ownerType: 'pseudorandom'}).then(\r\n        result => {\r\n          if(result.code == 0) {\r\n            this.setState({menuData: result.data});\r\n          }\r\n        }\r\n      )\r\n      return;\r\n    }\r\n    if(domain === \"buye\") {\r\n      this.props.queryResourceMenuByBuyId().then(\r\n        result => {\r\n          if(result.code == 0) {\r\n            this.setState({menuData: result.data});\r\n          }\r\n        }\r\n      )\r\n    }\r\n    if(domain === 'shop') {\r\n      (shopType == 1 || shopType == 2) && this.props.queryResourceMenuBySellerId({shopType}).then(\r\n        result => {\r\n          if(result.code == 0) {\r\n            this.setState({menuData: result.data});\r\n          }\r\n        }\r\n      )\r\n    }\r\n    if(domain === 'plat') {\r\n      this.props.queryResourceMenuByPuserId().then(\r\n        result => {\r\n          if(result.code == 0) {\r\n            this.setState({menuData: result.data});\r\n          }\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  // 根据name获取cookie值\r\n  getCookieByArray(name){\r\n    if(typeof document !== 'undefined'){\r\n      var cookies = document.cookie.split(';');\r\n      var c;\r\n      for(var i=0; i<cookies.length ; i++){\r\n        c = cookies[i].split('=');\r\n        if (c[0].replace(' ', '') == name) {\r\n          return c[1];\r\n        }\r\n      }\r\n    }else{\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // // 渲染menu\r\n  // renderMenu() {\r\n  //   var menu = [];\r\n  //   for(let i = 0 ; i < this.state.menuData.length ; i++){\r\n  //     // 进入第一层for循环，判断接口url是否与访问url相同，如果相同则后面代码不执行\r\n  //     if(this.pathname == this.state.menuData[i].url) {\r\n  //       menu.push({name: this.state.menuData[i].name, url: '//' + this.host + this.state.menuData[i].url});\r\n  //       return menu;\r\n  //     }\r\n  //     if(!this.state.menuData[i].children.length) continue;\r\n\r\n  //     // 进入第二层for循环，判断接口url是否与访问url相同，如果相同则后面代码不执行\r\n  //     for(let j = 0 ; j < this.state.menuData[i].children.length ; j++){\r\n  //       if(this.pathname == this.state.menuData[i].children[j].url) {\r\n  //         menu.push({name: this.state.menuData[i].name, url: '//' + this.host + this.state.menuData[i].url})\r\n  //         menu.push({name: this.state.menuData[i].children[j].name, url: '//' + this.host + this.state.menuData[i].children[j].url});\r\n  //         return menu;\r\n  //       }\r\n  //       if(!this.state.menuData[i].children[j].children.length) continue;\r\n\r\n  //       // 进入第三层for循环，判断接口url是否与访问url相同，如果相同则后面代码不执行\r\n  //       for(let k = 0 ; k < this.state.menuData[i].children[j].children.length ; k++){\r\n  //         if(this.pathname == this.state.menuData[i].children[j].children[k].url) {\r\n  //           menu.push({name: this.state.menuData[i].name, url: '//' + this.host + this.state.menuData[i].url})\r\n  //           menu.push({name: this.state.menuData[i].children[j].name, url: '//' + this.host + this.state.menuData[i].children[j].url});\r\n  //           menu.push({name: this.state.menuData[i].children[j].children[k].name, url: '//' + this.host + this.state.menuData[i].children[j].children[k].url});\r\n  //           return menu;\r\n  //         }\r\n  //         if(!this.state.menuData[i].children[j].children[k].children.length) continue;\r\n\r\n  //         // 进入第四层for循环，判断接口url是否与访问url相同，如果相同则后面代码不执行\r\n  //         for(let m = 0 ; m < this.state.menuData[i].children[j].children[k].children.length.length ; m++){\r\n  //           if(this.pathname == this.state.menuData[i].children[j].children[k].children[m].url) {\r\n  //             menu.push({name: this.state.menuData[i].name, url: '//' + this.host + this.state.menuData[i].url})\r\n  //             menu.push({name: this.state.menuData[i].children[j].name, url: '//' + this.host + this.state.menuData[i].children[j].url});\r\n  //             menu.push({name: this.state.menuData[i].children[j].children[k].name, url: '//' + this.host + this.state.menuData[i].children[j].children[k].url});\r\n  //             menu.push({name: this.state.menuData[i].children[j].children[k].children[m].name, url: '//' + this.host + this.state.menuData[i].children[j].children[k].children[m].url});\r\n  //             return menu;\r\n  //           }\r\n  //           if(!this.state.menuData[i].children[j].children[k].children[m].children.length) continue;\r\n  //         }\r\n  //       }\r\n  //     }\r\n  //   }\r\n  //   return menu;\r\n  // }\r\n\r\n  // // 渲染menu\r\n  // renderMenu(menuData) {\r\n  //   console.log(1);\r\n  //   for(let i = 0 ; i < menuData.length ; i++) {\r\n  //     menu.push({name: menuData[i].name, url: '//' + this.host + menuData[i].url});\r\n  //     if(this.pathname != menuData[i].url) {\r\n  //       if(menuData[i].children.length) {\r\n  //         return this.renderMenu(menuData[i].children);\r\n  //       }else{\r\n  //         menu = [];\r\n  //       }\r\n  //     }else{\r\n  //       return;\r\n  //     }\r\n  //   }\r\n  // }\r\n\r\n  // 渲染menu\r\n  renderMenu(data) {\r\n    if(this.state.willMenuData) return this.state.willMenuData\r\n    const flatten = (data) => {\r\n      data = data || []\r\n      return data.reduce((arr, {name, url, code, pid, children = []}) =>\r\n        arr.concat([{name, url, code, pid}], flatten(children)), [])\r\n    }\r\n    const arr = flatten(data)\r\n    const crumbsObj = arr.reduce((obj, v) => {\r\n      obj[v.code] = v;\r\n      return obj;\r\n    }, {});\r\n    let code = (arr.find((item, index, data) => item.url == this.pathname) || {}).code;\r\n    return this.getMenus(crumbsObj, code);\r\n  }\r\n\r\n  getMenus(obj, code) {\r\n    const menu = [];\r\n    if(!code) return menu;\r\n    const pushMenu = (code) => {\r\n      menu.unshift(obj[code]);\r\n      if(obj[code].pid != 0){\r\n        pushMenu(obj[obj[code].pid].code);\r\n      }\r\n    }\r\n    pushMenu(code);\r\n    return menu;\r\n  }\r\n\r\n  render () {\r\n    const menu = this.state.menuData.length && this.renderMenu(this.state.menuData);\r\n    return <div className=\"ui-breadcrumb\">\r\n        <JcBreadCrumb menu={menu} />\r\n      </div>\r\n  }\r\n}"]}