{"version":3,"sources":["../../src/components/CreatePage/CreatePageWrap.js"],"names":["CreatePage","query","queryCol","dispatch","props","onSubmit","bind","state","data","handleChangeRef","search","params","opt","url","async","then","result","code","setState","length","arr","i","key","urlParam","push","param","res","obj","j","col","Component"],"mappings":"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","file":"CreatePageWrap.js","sourcesContent":["import React, { Component } from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport Grid from './Grid/Grid';\r\nimport Search from './Search/Search';\r\nimport {query, queryCol} from './redux';\r\n\r\n@connect(\r\n    state => ({}),\r\n    dispatch => bindActionCreators({query, queryCol}, dispatch)\r\n)\r\n\r\nexport default class CreatePage extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.onSubmit = this.onSubmit.bind(this);\r\n        this.state = {\r\n            data: {}\r\n        }\r\n        this.props.handleChangeRef(this);\r\n    }\r\n    componentWillMount() {\r\n        const {search} = this.props;\r\n        this.onSubmit(search);\r\n    }\r\n    onSubmit(params, opt){\r\n        const {url, async, search} = this.props;\r\n        if(opt) params = search;\r\n        this.props.query(url, params).then(\r\n            result => {\r\n                if(result.code == 0) {\r\n                    this.setState({data: result.data});\r\n                    if(async && async.url) {\r\n                        if(!result.data || !result.data.result || !result.data.result.length) return;\r\n                        let arr = [];\r\n                        for(let i = 0 ; i < result.data.result.length ; i++) {\r\n                            for(let key in async.urlParam) {\r\n                                arr.push(result.data.result[i][async.urlParam[key]]);\r\n                            }\r\n                        }\r\n                        let param = {}\r\n                        for(let key in async.urlParam) {\r\n                            param[key] = arr;\r\n                        }\r\n                        this.props.queryCol(async.url, param).then(\r\n                            res => {\r\n                                if(res.code == 0) {\r\n                                    let obj = Object.assign({}, this.state.data);\r\n                                    for(let i = 0 ; i < res.data.length ; i++) {\r\n                                        for(let j = 0 ; j < async.col.length ; j++)\r\n                                        obj.result[i][async.col[j]] = res.data[i][async.col[j]];\r\n                                    }\r\n                                    this.setState({data: obj});\r\n                                }\r\n                            }\r\n                        )\r\n                    }\r\n                }\r\n            }\r\n        );\r\n    }\r\n    render() {\r\n        return <div>\r\n            <Search\r\n                {...this.props}\r\n                dataSource={this.state.data}\r\n                onSubmit={(params) => this.onSubmit(params)}\r\n            />\r\n            <Grid\r\n                {...this.props}\r\n                dataSource={this.state.data}\r\n                onSubmit={(params) => this.onSubmit(params)}\r\n            />\r\n        </div>\r\n    }\r\n}"]}