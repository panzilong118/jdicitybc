{"version":3,"sources":["../../../../../src/components/Release/ReleaseBasicInfo/v1.0.0/view/ReleaseBasicInfo.js"],"names":["Loading","props","error","pastDelay","ReleaseBasicInfo","state","components","that","instances","map","hook","value","JSON","parse","sourceModuleProps","moduleConfigProps","reduce","obj","item","eval","e","Ins","loader","then","object","default","loading","delay","render","loaded","Component","type","ifSave","edit","editStatus","editData","setEditData","saleAttributeData","updateSaleAttributeAction","updateItemTmplAction","itemTmplPublishVo","push","console","log","ifValid","dyComLoading","minHeight","templateId","Com","i"],"mappings":"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","file":"ReleaseBasicInfo.js","sourcesContent":["/**\r\n * @author chenyanhua\r\n * @dateTime 20180724\r\n * @file 发布商品-基础信息Tab组件\r\n */\r\nimport React, { Component } from 'react';\r\nimport Loadable from 'react-loadable';\r\nimport CategoryCascade from '../../../BasicCategoryCascade/v1.0.0/view/BindCategoryCascade';\r\nimport BasicName from '../../../BasicName/v1.0.0/view/index';\r\nimport { Spin } from 'jdcloudui';\r\n\r\nfunction Loading(props) {\r\n  if (props.error) {\r\n      return <div>Error!</div>;\r\n  } else if (props.pastDelay) {\r\n      // return <div style={{ 'height':'800px', 'paddingTop': '200px', 'textAlign': 'center'}}><Spin size=\"large\" /></div>;\r\n      return <div></div>\r\n  } else {\r\n      return null;\r\n  }\r\n}\r\nexport default class ReleaseBasicInfo extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      components: {}\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    // 加载动态tab组件,此处根据钩子查询组件\r\n    // this.props.loadBasicInfoComponents().then((result) => {\r\n    //   const components = this.loadInstance(result && result.data || {});\r\n    //   this.setState({\r\n    //     components: components\r\n    //   });\r\n    // },\r\n    //   (error) => {\r\n    //     console.log(error)\r\n    //   }\r\n    // );\r\n  }\r\n  loadInstance(components) {\r\n    var that = this;\r\n    var instances = {};\r\n    components && Object.keys(components).map((hook) => {\r\n      components[hook].map((value) => {\r\n        if (value[\"signature\"]) {\r\n          let props = {};\r\n          //处理config-->json.parse\r\n          props = JSON.parse(value['config']);\r\n          //处理moduleConfig-->json.parse,eval\r\n          let sourceModuleProps = JSON.parse(value['moduleConfig'])\r\n          let moduleConfigProps = Object.keys(sourceModuleProps).reduce((obj, item) => {\r\n            try {\r\n              obj[item] = eval(sourceModuleProps[item]);\r\n            } catch (e) {\r\n              obj[item] = '';\r\n            }\r\n            return obj;\r\n          }, {});\r\n          //合并config\r\n          props = Object.assign(props ? props : {}, moduleConfigProps ? moduleConfigProps : {});\r\n\r\n          var Ins = Loadable({\r\n            loader: () => import('../../..' + '/' + value[\"signature\"] + '/' + value[\"version\"] + '/view/index').then(object => object.default),\r\n            loading: Loading,\r\n            delay: 300,\r\n            render(loaded) {\r\n              let Component = loaded;\r\n              return <Component\r\n                {...props}\r\n                type={that.props.type} // 平台、供应商、店铺\r\n                key={`basic_info_${value[\"signature\"]}`}\r\n                ifSave={that.props.ifSave}\r\n                edit={that.props.edit}\r\n                editStatus={that.props.editStatus}\r\n                editData={that.props.editData}\r\n                setEditData={that.props.setEditData}\r\n                saleAttributeData={that.props.saleAttributeData || []}  //拼接后的销售规格数据\r\n                updateSaleAttributeAction={that.props.updateSaleAttributeAction} //更新销售规格数据的方法\r\n                updateItemTmplAction={that.props.updateItemTmplAction} //更新总数据的方法\r\n                itemTmplPublishVo={that.props.itemTmplPublishVo} // 当前已保存的总数据\r\n              />;\r\n            }\r\n          });\r\n          instances[hook] = instances[hook] || [];\r\n          instances[hook].push(Ins);\r\n        }\r\n      });\r\n    });\r\n    return instances;\r\n  }\r\n\r\n  render() {\r\n    console.log(this.props.itemTmplPublishVo)\r\n    return (\r\n      <div>\r\n        <h3 className=\"h3-title\">基础信息 </h3>\r\n        <BasicName\r\n          type={this.props.type} // 平台、供应商、店铺\r\n          ifSave={this.props.ifSave}\r\n          ifValid={this.props.ifValid}\r\n          edit={this.props.edit}\r\n          updateItemTmplAction={this.props.updateItemTmplAction} //更新总数据的方法\r\n          itemTmplPublishVo={this.props.itemTmplPublishVo} // 当前已保存的总数据\r\n        />\r\n        <CategoryCascade\r\n          type={this.props.type} // 平台、供应商、店铺\r\n          ifSave={this.props.ifSave}\r\n          ifValid={this.props.ifValid} //是否是已生效商品\r\n          edit={this.props.edit}\r\n          updateItemTmplAction={this.props.updateItemTmplAction} //更新总数据的方法\r\n          itemTmplPublishVo={this.props.itemTmplPublishVo} // 当前已保存的总数据\r\n        />\r\n                {/* 添加HOOK_BASICINFO_templateID 钩子加载该tab下的各种组件 */}\r\n\r\n          {/*<ReleaseSaleSpecification\r\n            ifSave={this.props.ifSave}\r\n            saleAttributeData={this.props.saleAttributeData || []} //拼接后的销售规格数据\r\n            updateSaleAttributeAction = {this.props.updateSaleAttributeAction}  //更新销售规格数据的方法\r\n          />\r\n          <ReleaseSaleInfo\r\n            saleAttributeData={this.props.saleAttributeData || []} // 销售规格数据\r\n            updateItemTmplAction = {this.props.updateItemTmplAction} // 更新总数据的方法\r\n            saveParamsRedux = {this.props.saveParamsRedux} // 总数据源\r\n          />\r\n        */}\r\n        {/*  动态加载组件 */}\r\n        {\r\n          this.props.dyComLoading?\r\n          <div style={{minHeight: '50px'}}>\r\n            <Spin size='large'>\r\n              {\r\n                (this.props.components[`HOOK_BASIC_INFO_${this.props.templateId}`] || []).map((Com, i) => {\r\n                  return (\r\n                    <Com />\r\n                  )\r\n                })\r\n              }\r\n            </Spin>\r\n          </div>:\r\n            (this.props.components[`HOOK_BASIC_INFO_${this.props.templateId}`] || []).map((Com, i) => {\r\n              return (\r\n                <Com />\r\n              )\r\n            })\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"]}