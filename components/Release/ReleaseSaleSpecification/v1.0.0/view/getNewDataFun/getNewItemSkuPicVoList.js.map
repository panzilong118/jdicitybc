{"version":3,"sources":["../../../../../../src/components/Release/ReleaseSaleSpecification/v1.0.0/view/getNewDataFun/getNewItemSkuPicVoList.js"],"names":["getNewItemSkuPicVoList","itemSkuPicVoList","saleAttributeData","combinedSaleAttributeData","getCombinedDataFromChecked","skuAttributesData","forEach","item","push","attributes","newItemlSkuVoList","index","old_index","getEqualIndex","newItem","changeToStrArray","length","map","result","i","newResult","array","strArr","itemArr","aid","toString","vid","two_array","attrItem","platformCategoryAttributeValues","attrValueItem","checked","checkedItem","attrId","aName","attrName","attrValueId","vName","attrValueName","doExchange","doubleArrays","len","results","indexs","specialSort","start","Array","temp"],"mappings":"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","file":"getNewItemSkuPicVoList.js","sourcesContent":["/**\r\n * 遍历已选的销售规格数据saleAttributeData，重新组合itemSkuPicVoList数据\r\n * 对比saleAttributeData与itemTmplPublishVo.itemSkuPicVoList\r\n * 不在saleAttributeData里的url ,alt不展示\r\n * @param itemSkuPicVoList ： 已存在sku商品图片\r\n * @param saleAttributeData :  销售规格数据源\r\n * @return 新的图片信息表格数据源\r\n */\r\n\r\nfunction getNewItemSkuPicVoList(itemSkuPicVoList, saleAttributeData) {\r\n    let combinedSaleAttributeData = getCombinedDataFromChecked(saleAttributeData); // 组合已选销售规格数据\r\n    let skuAttributesData = [];\r\n    itemSkuPicVoList.forEach((item) => {\r\n        skuAttributesData.push(item.attributes || []);\r\n    });\r\n    let newItemlSkuVoList = [];\r\n    combinedSaleAttributeData.forEach((item, index) => {\r\n        var old_index = getEqualIndex(skuAttributesData,item);\r\n        if(old_index >=0){\r\n            newItemlSkuVoList.push(itemSkuPicVoList[old_index]);\r\n        }else{\r\n            newItemlSkuVoList.push({\r\n                \"attributes\": combinedSaleAttributeData[index],\r\n                \"url\":\"\",\r\n                \"alt\":\"\"\r\n            });\r\n        }\r\n    });\r\n    return newItemlSkuVoList;\r\n}\r\n/**\r\n//对比选中的销售规格与之前保存的销售规格，并保存下标。\r\n */\r\nfunction  getEqualIndex(skuAttributesData,item){\r\n    let index = -1;\r\n    let newItem = changeToStrArray(item);\r\n\r\n    if(skuAttributesData.length>0) {\r\n        skuAttributesData.length > 0 && skuAttributesData.map((result, i) => {\r\n           let newResult = changeToStrArray(result);\r\n          if (JSON.stringify(newItem) == JSON.stringify(newResult)) {\r\n                index = i;\r\n          }\r\n        })\r\n    }\r\n    return index;\r\n}\r\n\r\n\r\n/**\r\n * 转换对象\r\n * [{aid:**, aName:**, vid:**,vName:**},{}] => [{aid:\"\",vid:\"\"}];\r\n */\r\nfunction changeToStrArray(array) {\r\n  let strArr = [];\r\n  array.forEach((itemArr) => {\r\n    strArr.push({\r\n      aid:itemArr.aid.toString(),\r\n      vid:itemArr.vid.toString()\r\n    });\r\n  });\r\n  return strArr;\r\n}\r\n/**\r\n * 组合选中的销售规格数据\r\n */\r\nfunction getCombinedDataFromChecked(saleAttributeData) {\r\n    let two_array = [];\r\n    saleAttributeData.forEach((attrItem) => {\r\n        let array = [];\r\n        attrItem.platformCategoryAttributeValues.forEach((attrValueItem) => {\r\n            if (attrValueItem.checked) {\r\n                const checkedItem = {\r\n                    aid: attrItem.attrId,\r\n                    aName: attrItem.attrName,\r\n                    vid: attrValueItem.attrValueId,\r\n                    vName: attrValueItem.attrValueName\r\n                }\r\n                array.push(checkedItem);\r\n            }\r\n        });\r\n        if (array.length > 0) {\r\n            two_array.push(array);\r\n        }\r\n    });\r\n    return doExchange(two_array);\r\n}\r\n/**\r\n * // 二维数组的排列组合\r\n **/\r\n\r\nfunction doExchange(doubleArrays) {\r\n    var array = doubleArrays;\r\n    var len = array.length;\r\n    var results = [];\r\n    var indexs = {};\r\n    function specialSort(start) {\r\n        start++;\r\n        if (start > len - 1) {\r\n            return;\r\n        }\r\n        if (!indexs[start]) {\r\n            indexs[start] = 0;\r\n        }\r\n        if (!(array[start] instanceof Array)) {\r\n            array[start] = [array[start]];\r\n        }\r\n        for (indexs[start] = 0; indexs[start] < array[start].length; indexs[start]++) {\r\n            specialSort(start);\r\n            if (start == len - 1) {\r\n                var temp = [];\r\n                for (var i = len - 1; i >= 0; i--) {\r\n                    if (!(array[start - i] instanceof Array)) {\r\n                        array[start - i] = [array[start - i]];\r\n                    }\r\n                    temp.push(array[start - i][indexs[start - i]]);\r\n                }\r\n                results.push(temp);\r\n            }\r\n        }\r\n    }\r\n\r\n    specialSort(-1);\r\n    return results;\r\n}\r\nexport default getNewItemSkuPicVoList;\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]}