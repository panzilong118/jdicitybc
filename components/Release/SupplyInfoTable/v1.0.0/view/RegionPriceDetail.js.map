{"version":3,"sources":["../../../../../src/components/Release/SupplyInfoTable/v1.0.0/view/RegionPriceDetail.js"],"names":["RegionPriceDetail","props","context","handleVisibleChange","visible","console","log","setState","state","visiblePop","sourceData","totalPrice","priceList","itemTmplPublishVo","itemPerfectVo","preSkuPriceVoList","index","areaPriceList","result","price","areaStr","arrArea","length","j","areaId","supplyPrice","k","areaName","push","shift","resultarr","areaNames","split","i","edit","map","styles","areaBody","regionPriceTitle","regionPrice","regionDataTransform","skuParamListTransform","showAreaPrice","source","width","paddingTop","regionPriceCol","regionTitleText","regionPriceBody","createAreaDom","Component"],"mappings":"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","file":"RegionPriceDetail.js","sourcesContent":["/**\r\n * Created by huangxiao3 on 2017/3/20.\r\n * 店铺发布和编辑商品时的地域价查看组件\r\n */\r\n\r\nimport React, {Component} from 'react';\r\nimport { Modal, Button, Form, Input, Icon, Row, Col,Popover, Checkbox } from 'jdcloudui';\r\n// import {connect} from 'react-redux';\r\n// import {bindActionCreators} from 'redux';\r\n// import BaseComponent  from '../../Common/BaseComponent';\r\nimport styles from './style/RegionPriceDetail.less';\r\n\r\n\r\nexport default class RegionPriceDetail extends Component {\r\n\r\n  constructor(props, context) {\r\n    super(props, context);\r\n    this.state = {\r\n      visible: false,\r\n      visiblePop:{},\r\n    };\r\n    this.sourceData=[];\r\n    this.totalPrice='';\r\n  }\r\n\r\n//  componentWillReceiveProps(){\r\n//     this.sourceData = this.regionDataTransform();\r\n//  }\r\n\r\n\r\n  regionDataTransform(){\r\n    console.log('--------------regionData')\r\n    let priceList = this.props.itemTmplPublishVo.itemPerfectVo.preSkuPriceVoList[this.props.index] ? \r\n    this.props.itemTmplPublishVo.itemPerfectVo.preSkuPriceVoList[this.props.index].areaPriceList:[];\r\n    console.log(priceList)\r\n    var result = [];\r\n    var price = '';\r\n    var areaStr = '';\r\n    let arrArea =[];\r\n    if(priceList.length>0){\r\n      for(var j in priceList){\r\n        if(priceList[j].areaId==0 || priceList[j].areaId=='0'){\r\n          this.totalPrice = priceList[j].supplyPrice\r\n          // arrArea = priceList.splice(j,1);\r\n        }\r\n      }\r\n    }\r\n    console.log(arrArea)\r\n\r\n    if(priceList.length>0){\r\n      price =priceList[0].supplyPrice;\r\n      for(var k in priceList){\r\n        if(price===priceList[k].supplyPrice){\r\n          price = priceList[k].supplyPrice;\r\n          areaStr = areaStr+priceList[k].areaName+' ';\r\n        }else{\r\n          result.push({price:price,areaStr:areaStr});\r\n          price = priceList[k].supplyPrice;\r\n          areaStr = priceList[k].areaName+' ';\r\n        }\r\n      }\r\n      result.push({price:price,areaStr:areaStr});\r\n    }\r\n    // if(arrArea && arrArea.length){\r\n    //   result.unshift({price:arrArea[0].supplyPrice,areaStr:arrArea[0].areaName})\r\n    // }\r\n    result.shift()\r\n    console.log(result)\r\n    return result;\r\n  }\r\n\r\n\r\n  //from areaList\r\n  skuParamListTransform(){\r\n    var priceList = this.props.itemTmplPublishVo.itemPerfectVo.preSkuPriceVoList[this.props.index] ? \r\n                    this.props.itemTmplPublishVo.itemPerfectVo.preSkuPriceVoList[this.props.index].areaPriceList:[];\r\n    console.log('------------------areaList')\r\n    let resultarr =[]\r\n    if(priceList.length>0){\r\n      let areaStr = ''\r\n      price =priceList[0].supplyPrice;\r\n      for(var k in priceList){\r\n        if(price===priceList[k].supplyPrice){\r\n          price = priceList[k].supplyPrice;\r\n          areaStr = areaStr+priceList[k].areaName+' ';\r\n        }else{\r\n          resultarr.push({price:price,areaStr:areaStr});\r\n          price = priceList[k].supplyPrice;\r\n          areaStr = priceList[k].areaName+' ';\r\n        }\r\n      }\r\n      resultarr.push({price:price,areaStr:areaStr});\r\n    }\r\n    let sourceData = resultarr\r\n    console.log(sourceData)\r\n    var result =[];\r\n    var price = '';\r\n    var areaStr = '';\r\n    for(var k in sourceData){\r\n      let areaNames = sourceData[k] && sourceData[k].areaStr &&sourceData[k].areaStr.split(' ') || [];\r\n      areaStr='';\r\n      for(let i = 0;i<areaNames.length;++i){\r\n        if(areaNames[i]!='全国'){\r\n          areaStr+=areaNames[i]+' ';\r\n        }else{\r\n          this.totalPrice = sourceData[k].price;\r\n        }\r\n      }\r\n      if(areaStr!=''){\r\n          console.log('area')\r\n        price = sourceData[k].price;\r\n        result.push({price:price,areaStr:areaStr});\r\n      }\r\n    }\r\n    console.log(result)\r\n    return result;\r\n  }\r\n\r\n  createAreaDom(){\r\n    console.log('----------展示地域价')\r\n    console.log(this.sourceData)\r\n    var sourceData = this.sourceData;\r\n    if(!this.props.edit){\r\n      sourceData.shift()\r\n    }\r\n    var result = sourceData.map((k)=>{\r\n      return (\r\n        <div>\r\n          <div className=\"pt10 pb10 pl15 pr15\">\r\n            {k.areaStr}\r\n          </div>\r\n          <div className={styles.areaBody}>\r\n            <div className=\"pt10 pb10 pl10 pr15\">\r\n              <span className={styles.regionPriceTitle}>供货价：</span>\r\n              <span className={styles.regionPrice}>￥{k.price}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    });\r\n    return result;\r\n  }\r\n\r\n  //设置地域价窗口：关闭\r\n  handleCancel() {\r\n    this.setState({\r\n      visible: false,\r\n    });\r\n  }\r\n\r\n  showArea(k){\r\n    this.state.visiblePop[k]=true\r\n    this.setState({\r\n      visiblePop:this.state.visiblePop\r\n    })\r\n  }\r\n\r\n  handleVisibleChange = (visible) => {\r\n      console.log(visible)\r\n    this.setState({ visible });\r\n  }\r\n\r\n  render() {\r\n\r\n      if(this.props.edit){\r\n        this.sourceData = this.regionDataTransform();\r\n      } else {\r\n       this.sourceData = this.skuParamListTransform();\r\n      }\r\n      console.log(this.sourceData)\r\n\r\n\r\n    // let showAreaPrice = false;\r\n    // if(this.sourceData && this.sourceData.length>0){\r\n     let showAreaPrice = true;\r\n  //  }\r\n\r\n    let source = (\r\n      <div style={{width:'300px'}}>\r\n        <div>\r\n          <div>\r\n              <span className=\"f-fwb f-fs14\">\r\n              全国统一价\r\n              </span>\r\n          </div>\r\n          <div>\r\n              <span className={styles.regionPriceTitle} style={{paddingTop:'10px'}}>\r\n                供货价：\r\n              </span>\r\n            <span className={styles.regionPriceCol}>\r\n                ￥{this.props.totalPrice?this.props.totalPrice:this.totalPrice}\r\n              </span>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <div className=\"pb10 pt20 f-fwb\">\r\n              <span className={styles.regionTitleText}>\r\n                地域价\r\n              </span>\r\n          </div>\r\n          {showAreaPrice &&\r\n          <div className={styles.regionPriceBody}>\r\n            {showAreaPrice && this.createAreaDom()}\r\n          </div>\r\n          }\r\n        </div>\r\n        {/*<div style={{float:'right',marginTop:'10px'}}>\r\n          <Button type=\"primary\" onClick={()=>this.handleCancel()}>确定</Button>\r\n        </div>*/}\r\n      </div>\r\n    )\r\n\r\n    return (\r\n      <Popover\r\n        title='查看地域价'\r\n        trigger=\"click\"\r\n        content={source}\r\n        onVisibleChange={this.handleVisibleChange}\r\n      >\r\n        <a  className='ml10 text-link'>\r\n          查看\r\n        </a>\r\n      </Popover>\r\n    );\r\n  }\r\n}"]}