{"version":3,"sources":["../../../../../../src/components/Release/ReleasePriceAndStock/v1.0.2/config/Container/ReleasePriceAndStockConfig.js"],"names":["FormItem","Item","ev","ReleasePriceAndStockConfig","components","state","centerConfig","saveConfig","searchConfig","create","AppConfigHoc","props","context","handleSubmit","form","validateFields","err","values","examin","setState","loading","that","saveConfigHoc","componentId","pageId","config","then","result","callParent","success","error","onCheckboxChange","e","field","setFieldsValue","target","checked","spinLoading","event","origin","indexOf","source","postMessage","window","addEventListener","receiveMessage","queryString","parse","location","search","href","split","length","searchConfigHoc","forceUpdate","console","log","testPropsFromHoc","getFieldDecorator","formItemLayout","labelCol","span","wrapperCol","width","overflow","margin","valuePropName","initialValue","ifProposalPrice","undefined","Component","contextTypes","store","PropTypes","object"],"mappings":"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","file":"ReleasePriceAndStockConfig.js","sourcesContent":["/**\r\n * @author chenyanhua\r\n * @date 2018-08-03\r\n * @file 销售信息表格：自定义扩展列\r\n * /item-shop-view/configs/components-react/ReleasePriceAndStock/v1.0.1\r\n */\r\nimport React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { saveConfig, searchConfig } from './redux';\r\nimport queryString from 'query-string';\r\nimport { Row, Col, Checkbox, Form, Button, message, Spin, Icon, Tooltip  } from 'jdcloudui';\r\nimport PropTypes from 'prop-types';\r\nconst FormItem = Form.Item;\r\nimport AppConfigHoc from '../../../../AppConfig/AppConfigHoc';\r\n\r\nimport './style.css';\r\nlet ev;\r\n@connect(state => ({ components: state.centerConfig }), { saveConfig, searchConfig })\r\n@AppConfigHoc\r\n@Form.create()\r\nexport default class ReleasePriceAndStockConfig extends Component {\r\n    static contextTypes = {\r\n        store: PropTypes.object\r\n    }\r\n\r\n    constructor(props, context) {\r\n        super(props, context);\r\n        this.componentId = '';\r\n        this.pageId = '';\r\n        this.state = { loading: false, spinLoading: true };\r\n\r\n    }\r\n\r\n    handleSubmit = () => {\r\n        this.props.form.validateFields((err, values) => {\r\n            if (!err) {\r\n                let examin = {};\r\n\r\n                this.setState({ loading: true });\r\n                var that = this;\r\n                this.props.saveConfigHoc({ componentId: this.componentId, pageId: this.pageId, config: JSON.stringify(values) }).then(\r\n                    (result) => {\r\n                        that.callParent();\r\n                        message.success('修改成功', 2);\r\n                        that.setState({ loading: false });\r\n                    },\r\n                    (error) => {\r\n                        message.error(error, 2);\r\n                        that.setState({ loading: false });\r\n\r\n                    }\r\n                )\r\n            }\r\n        });\r\n    }\r\n\r\n    receiveMessage(event) {\r\n        if(event && event.origin.indexOf('platform')>=0){\r\n            ev = event;\r\n        }\r\n    }\r\n\r\n    callParent() {\r\n        ev && ev.source && ev.source.postMessage && ev.source.postMessage('ok', ev.origin);\r\n    }\r\n\r\n    componentDidMount() {\r\n        window.addEventListener('message', this.receiveMessage, false);\r\n        const componentId = queryString.parse(window.location.search).componentId;\r\n        const pageId = queryString.parse(window.location.search).pageId;\r\n        let source = window.location.href.split('/');\r\n        let length = source.length;\r\n        /*        this.componentId = source[length-2];\r\n                this.pageId = source[length-1];*/\r\n        this.componentId = componentId;\r\n        this.pageId = pageId;\r\n        this.props.searchConfigHoc({ componentId: this.componentId, pageId: this.pageId }).then(\r\n            (result) => {\r\n                this.setState({ ...result, spinLoading: false })\r\n                this.forceUpdate();\r\n            },\r\n            (error) => {\r\n                message.error(error, 2);\r\n                this.setState({ spinLoading: false })\r\n            }\r\n        );\r\n        console.log('componentId----', this.componentId)\r\n        console.log('pageId-----', this.pageId)\r\n    }\r\n\r\n    render() {\r\n        console.log('this.props.testPropsFromHoc is:', this.props.testPropsFromHoc);\r\n        console.log('this.props.saveConfigHoc is:', this.props.saveConfigHoc);\r\n        const { getFieldDecorator } = this.props.form;\r\n        const formItemLayout = { labelCol: { span: 18 }, wrapperCol: { span: 6 } };\r\n        return (\r\n            <Spin spinning={this.state.spinLoading}>\r\n                <div style={{ width: '600px', overflow:'auto', margin: 'auto' }}>\r\n                    <Form>\r\n                        <Row>\r\n                            <h3 style={{'lineHeight': '50px'}}>价格及库存信息列表可选展示条目(默认不展示) : </h3>\r\n                            <Col span={4}>\r\n                                <FormItem label=\"建议售价\" {...formItemLayout}>\r\n                                    {getFieldDecorator('ifProposalPrice', {\r\n                                        valuePropName: 'checked',\r\n                                        initialValue: this.state.ifProposalPrice === undefined ? false : this.state.ifProposalPrice\r\n                                    })(\r\n                                        <Checkbox />\r\n                                    )}\r\n                                </FormItem>\r\n                            </Col>\r\n                        </Row>\r\n                    </Form>\r\n                    <div className=\"buttonFooter\">\r\n                        <Button type=\"primary\" onClick={() => this.handleSubmit()} loading={this.state.loading}>保存</Button>\r\n                        <Button className=\"ml15\" onClick={() => this.callParent()}>取消</Button>\r\n                    </div>\r\n                </div>\r\n            </Spin>\r\n        );\r\n    }\r\n    /**\r\n     * @param e checkbox 对象\r\n     * @param field 修改的字段\r\n     */\r\n    onCheckboxChange = (e, field) => {\r\n        this.props.form.setFieldsValue({\r\n            [field]: e.target.checked\r\n        });\r\n    }\r\n}\r\n"]}